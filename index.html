<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BAILEO BPMP Provinsi Maluku</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-blue': '#1e40af',
                        'secondary-blue': '#3b82f6',
                        'accent-purple': '#8b5cf6',
                        'light-purple': '#f3f4f6'
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .nav-item {
            transition: all 0.3s ease;
            position: relative;
        }
        .nav-item:hover {
            transform: translateY(-2px);
        }
        .nav-item::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -2px;
            left: 50%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }
        .nav-item:hover::after {
            width: 100%;
        }
        .active-nav {
            background: linear-gradient(135deg, #1e40af, #8b5cf6);
            color: white;
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .gradient-bg {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 50%, #8b5cf6 100%);
        }
        .tab-button {
            transition: all 0.3s ease;
        }
        .tab-button.active {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Fixed Navbar -->
    <header class="bg-white shadow-lg fixed top-0 w-full z-50">
        <div class="container mx-auto px-4">
            <!-- Logo Section -->
            <div class="flex items-center justify-between py-4 border-b border-gray-100">
                <div class="flex items-center space-x-4">
                    <img src="https://i.imgur.com/Q0dFcm7.png" 
                         alt="Logo BAILEO BPMP Provinsi Maluku" 
                         class="h-12 w-12 object-contain">
                    <div>
                        <h1 class="text-2xl font-bold text-primary-blue">BAILEO</h1>
                        <p class="text-xs text-gray-600">BPMP Provinsi Maluku</p>
                    </div>
                </div>
                <button id="mobile-menu-btn" class="md:hidden p-2 rounded-lg hover:bg-gray-100">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Navigation -->
            <nav class="py-3" id="navbar">
                <div class="flex flex-col md:flex-row md:justify-center gap-2 md:gap-6" id="nav-menu">
                    <button onclick="showPage('home')" class="nav-item px-4 py-2 rounded-lg text-sm font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-600" id="nav-home">
                        ğŸ  Beranda
                    </button>
                    <button onclick="showPage('buku-tamu')" class="nav-item px-4 py-2 rounded-lg text-sm font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-600" id="nav-buku-tamu">
                        ğŸ“ Buku Tamu
                    </button>
                    <button onclick="showPage('survey')" class="nav-item px-4 py-2 rounded-lg text-sm font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-600" id="nav-survey">
                        ğŸ“Š Survey
                    </button>
                    <button onclick="showPage('jenis-layanan')" class="nav-item px-4 py-2 rounded-lg text-sm font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-600" id="nav-jenis-layanan">
                        ğŸ”§ Jenis Layanan
                    </button>
                    <button onclick="showPage('dashboard-ult')"
<a href="https://sites.google.com/view/dashboardbpmpmaluku" target="_blank" class="nav-item px-4 py-2 rounded-lg text-sm font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-600" id="nav-cerdas">
    ğŸš€ Cerdas (Dashboard Prioritas)
</a>
 class="nav-item px-4 py-2 rounded-lg text-sm font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-600" id="nav-dashboard-ult">
                        ğŸ“ˆ Dashboard ULT
                    </button>
                    <button onclick="showPage('hubungi-kami')" class="nav-item px-4 py-2 rounded-lg text-sm font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-600" id="nav-hubungi-kami">
                        ğŸ“ Hubungi Kami
                    </button>
                    <a href="https://sippn.menpan.go.id/instansi/balai-penjaminan-mutu-pendidikan-provinsi-maluku-175017" target="_blank" class="nav-item px-4 py-2 rounded-lg text-sm font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-600" id="nav-sippn">
                        ğŸŒ SIPPN
                    </a>
                </div>
            </nav>
        </div>
    </header>

    <!-- Welcome Popup -->
    <div id="welcomePopup" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl shadow-2xl max-w-md w-full mx-4 transform scale-95 opacity-0 transition-all duration-300" id="popupContent">
            <!-- Close Button -->
            <button onclick="closeWelcomePopup()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors z-10">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            
            <!-- Popup Content -->
            <div class="p-8 text-center">
                <!-- Logo -->
                <div class="mb-6">
                    <img src="https://i.imgur.com/Q0dFcm7.png" 
                         alt="Logo BAILEO BPMP Provinsi Maluku" 
                         class="h-20 w-20 object-contain mx-auto mb-4">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">Selamat Datang di BAILEO</h2>
                    <p class="text-gray-600 text-sm">BPMP Provinsi Maluku</p>
                </div>
                
                <!-- Welcome Message -->
                <div class="mb-6">
                    <p class="text-gray-700 leading-relaxed mb-4">
                        Terima kasih telah mengunjungi platform digital BAILEO. 
                        Silakan isi buku tamu digital kami untuk mencatat kunjungan Anda.
                    </p>
                </div>
                
                <!-- Action Buttons -->
                <div class="space-y-3">
                    <!-- Guest Book Button -->
                    <button onclick="openGuestBookFromPopup()" 
                            class="w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105">
                        <div class="flex items-center justify-center space-x-2">
                            <span class="text-xl">ğŸ“</span>
                            <span>Isi Buku Tamu</span>
                        </div>
                    </button>
                    
                    <!-- Skip Button -->
                    <button onclick="closeWelcomePopup()" 
                            class="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-6 rounded-xl transition-all duration-300">
                        Lewati untuk sekarang
                    </button>
                </div>
                
                <!-- Don't show again option -->
                <div class="mt-4 pt-4 border-t border-gray-100">
                    <label class="flex items-center justify-center space-x-2 text-sm text-gray-600 cursor-pointer">
                        <input type="checkbox" id="dontShowAgain" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                        <span>Jangan tampilkan lagi hari ini</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="pt-32 pb-16">
        <!-- Home Page -->
        <div id="page-home" class="page-content fade-in">
            <div class="container mx-auto px-4">
                <div class="text-center max-w-6xl mx-auto">
                    <!-- Hero Section -->
                    <div class="gradient-bg rounded-3xl shadow-2xl p-8 md:p-16 mb-12 text-white">
                        <div class="mb-8">
                            <!-- BAILEO Logo -->
                            <div class="flex justify-center mb-4">
                                <img src="https://i.imgur.com/Q0dFcm7.png" 
                                     alt="Logo BAILEO BPMP Provinsi Maluku" 
                                     class="h-80 w-80 object-contain drop-shadow-lg">
                            </div>
                            <h1 class="text-5xl md:text-7xl font-bold mb-6">BAILEO</h1>
                            <p class="text-xl md:text-2xl mb-8 opacity-90">Bersama Andalkan Informasi Layanan Elektronik Online</p>
                            <p class="text-lg opacity-80">BPMP Provinsi Maluku</p>
                        </div>
                    </div>
                    
                    <!-- Features Grid -->
                    <div class="grid md:grid-cols-3 gap-8 mb-12">
                        <div onclick="showPage('buku-tamu')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer">
                            <div class="text-4xl mb-4">ğŸ“</div>
                            <h3 class="text-xl font-bold text-gray-800 mb-3">Buku Tamu</h3>
                            <p class="text-gray-600">Daftarkan kunjungan Anda dengan mudah dan praktis</p>
                        </div>
                        <div onclick="showPage('survey')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer">
                            <div class="text-4xl mb-4">ğŸ“Š</div>
                            <h3 class="text-xl font-bold text-gray-800 mb-3">Survey Kepuasan</h3>
                            <p class="text-gray-600">Berikan penilaian terhadap kualitas layanan kami</p>
                        </div>
                        <div onclick="showPage('jenis-layanan')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer">
                            <div class="text-4xl mb-4">ğŸ”§</div>
                            <h3 class="text-xl font-bold text-gray-800 mb-3">Jenis Layanan</h3>
                            <p class="text-gray-600">Akses berbagai layanan dalam satu platform</p>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-2xl shadow-lg p-8 mb-12">
                        <h2 class="text-2xl font-bold text-gray-800 mb-4">Selamat Datang</h2>
                        <p class="text-gray-600 leading-relaxed">
                            Platform digital BAILEO hadir untuk memberikan kemudahan akses layanan BPMP Provinsi Maluku. 
                            Nikmati berbagai layanan elektronik yang terintegrasi untuk mendukung peningkatan mutu pendidikan di Maluku.
                        </p>
                    </div>
                    
                    <!-- Visitor Statistics -->
                    <div class="bg-white rounded-2xl shadow-lg p-6">
                        <div class="text-center">
                            <h3 class="text-xl font-bold text-gray-800 mb-6">ğŸ“Š Statistik Pengunjung Real-Time</h3>
                            
                            <!-- Main Statistics -->
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                <div class="text-center p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl">
                                    <div class="text-4xl mb-3">ğŸ‘¥</div>
                                    <div class="text-3xl font-bold text-blue-600 mb-2" id="visitorCount">0</div>
                                    <p class="text-gray-700 font-medium">Total Pengunjung</p>
                                    <p class="text-gray-500 text-xs mt-1">Berdasarkan loading halaman web</p>
                                </div>
                                <div class="text-center p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-xl">
                                    <div class="text-4xl mb-3">ğŸ“…</div>
                                    <div class="text-3xl font-bold text-green-600 mb-2" id="todayVisitors">0</div>
                                    <p class="text-gray-700 font-medium">Hari Ini</p>
                                    <p class="text-gray-500 text-xs mt-1">Pengunjung unik hari ini</p>
                                </div>
                                <div class="text-center p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl">
                                    <div class="text-4xl mb-3">ğŸŒ</div>
                                    <div class="text-3xl font-bold text-purple-600 mb-2" id="onlineUsers">1</div>
                                    <p class="text-gray-700 font-medium">Online Sekarang</p>
                                    <p class="text-gray-500 text-xs mt-1">Aktif dalam 5 menit terakhir</p>
                                </div>
                            </div>
                            
                            <!-- Additional Statistics -->
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                                <div class="text-center p-3 bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg border border-orange-200">
                                    <div class="text-2xl mb-2">ğŸ“ˆ</div>
                                    <div class="text-xl font-bold text-orange-600 mb-1" id="avgDailyVisitors">0</div>
                                    <p class="text-gray-700 font-medium text-sm">Rata-rata Harian</p>
                                    <p class="text-gray-500 text-xs">Pengunjung per hari</p>
                                </div>
                                <div class="text-center p-3 bg-gradient-to-br from-red-50 to-red-100 rounded-lg border border-red-200">
                                    <div class="text-2xl mb-2">â°</div>
                                    <div class="text-lg font-bold text-red-600 mb-1" id="peakHour">10:00</div>
                                    <p class="text-gray-700 font-medium text-sm">Jam Puncak</p>
                                    <p class="text-gray-500 text-xs">Traffic tertinggi</p>
                                </div>
                                <div class="text-center p-3 bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-lg border border-indigo-200">
                                    <div class="text-2xl mb-2">ğŸ”¥</div>
                                    <div class="text-sm font-bold text-indigo-600 mb-1" id="popularService">Buku Tamu</div>
                                    <p class="text-gray-700 font-medium text-sm">Layanan Terpopuler</p>
                                    <p class="text-gray-500 text-xs">Paling banyak diakses</p>
                                </div>
                                <div class="text-center p-3 bg-gradient-to-br from-teal-50 to-teal-100 rounded-lg border border-teal-200">
                                    <div class="text-2xl mb-2">âš¡</div>
                                    <div class="text-lg font-bold text-teal-600 mb-1" id="responseRate">98%</div>
                                    <p class="text-gray-700 font-medium text-sm">Tingkat Respons</p>
                                    <p class="text-gray-500 text-xs">Respons layanan</p>
                                </div>
                            </div>
                            
                            <!-- Real-time indicator -->
                            <div class="flex items-center justify-center space-x-2 text-sm text-gray-600">
                                <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                                <span>Data diperbarui secara real-time</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Buku Tamu Page -->
        <div id="page-buku-tamu" class="page-content hidden fade-in">
            <div class="container mx-auto px-4">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-bold text-gray-800 mb-4">ğŸ“ Buku Tamu</h2>
                    <p class="text-gray-600 text-lg">Silakan isi buku tamu digital kami</p>
                </div>
                <div class="bg-white rounded-3xl shadow-2xl p-6 max-w-5xl mx-auto">
                    <!-- Fallback button jika iframe tidak berfungsi -->
                    <div class="text-center mb-6">
                        <p class="text-gray-600 mb-4">Jika form tidak muncul, klik tombol di bawah ini:</p>
                        <a href="https://docs.google.com/forms/d/e/1FAIpQLSdv95EDEEa1LLhESdn8lXx4-7sojInLG2Qg8sDPf_k98TpcVQ/viewform" 
                           target="_blank" 
                           class="inline-block bg-gradient-to-r from-blue-500 to-purple-600 text-white px-8 py-3 rounded-xl font-semibold hover:from-blue-600 hover:to-purple-700 transition-all duration-300 shadow-lg">
                            ğŸ”— Buka Buku Tamu di Tab Baru
                        </a>
                    </div>
                    
                    <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSdv95EDEEa1LLhESdn8lXx4-7sojInLG2Qg8sDPf_k98TpcVQ/viewform?usp=pp_url&embedded=true" 
                            width="100%" 
                            height="1200" 
                            frameborder="0" 
                            marginheight="0" 
                            marginwidth="0"
                            class="rounded-2xl border-0"
                            sandbox="allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox"
                            loading="lazy">
                        <div class="text-center p-8">
                            <p class="text-gray-600 mb-4">Form sedang dimuat...</p>
                            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"></div>
                        </div>
                    </iframe>
                </div>
            </div>
        </div>

        <!-- Survey Page -->
        <div id="page-survey" class="page-content hidden fade-in">
            <div class="container mx-auto px-4">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-bold text-gray-800 mb-4">ğŸ“Š Survey Kepuasan</h2>
                    <p class="text-gray-600 text-lg">Bantu kami meningkatkan kualitas layanan</p>
                </div>
                <div class="bg-white rounded-3xl shadow-2xl p-6 max-w-5xl mx-auto">
                    <!-- Fallback button jika iframe tidak berfungsi -->
                    <div class="text-center mb-6">
                        <p class="text-gray-600 mb-4">Jika form tidak muncul, klik tombol di bawah ini:</p>
                        <a href="https://docs.google.com/forms/d/e/1FAIpQLSdmmF1uTfuDPWfnYMxRW-JNWKcw1t4a3I_HzSfbvKQUK2UbAw/viewform" 
                           target="_blank" 
                           class="inline-block bg-gradient-to-r from-blue-500 to-purple-600 text-white px-8 py-3 rounded-xl font-semibold hover:from-blue-600 hover:to-purple-700 transition-all duration-300 shadow-lg">
                            ğŸ”— Buka Survey di Tab Baru
                        </a>
                    </div>
                    
                    <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSdmmF1uTfuDPWfnYMxRW-JNWKcw1t4a3I_HzSfbvKQUK2UbAw/viewform?usp=pp_url&embedded=true" 
                            width="100%" 
                            height="1200" 
                            frameborder="0" 
                            marginheight="0" 
                            marginwidth="0"
                            class="rounded-2xl border-0"
                            sandbox="allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox"
                            loading="lazy">
                        <div class="text-center p-8">
                            <p class="text-gray-600 mb-4">Form sedang dimuat...</p>
                            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"></div>
                        </div>
                    </iframe>
                </div>
            </div>
        </div>

        <!-- Jenis Layanan Page -->
        <div id="page-jenis-layanan" class="page-content hidden fade-in">
            <div class="container mx-auto px-4">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-bold text-gray-800 mb-4">ğŸ”§ Jenis Layanan</h2>
                    <p class="text-gray-600 text-lg">Pilih layanan yang Anda butuhkan</p>
                </div>
                
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto">
                    <div onclick="showPeminjamanFasilitas()" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer">
                        <div class="text-4xl mb-4">ğŸ¢</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">Peminjaman Fasilitas</h3>
                        <p class="text-gray-600">Layanan peminjaman fasilitas BPMP</p>
                    </div>
                    
                    <div onclick="showPage('permintaan-data')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer">
                        <div class="text-4xl mb-4">ğŸ“‹</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">Permintaan Data dan Informasi</h3>
                        <p class="text-gray-600">Akses data dan informasi pendidikan</p>
                    </div>
                    
                    <div onclick="showPage('kerjasama-mutu')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer">
                        <div class="text-4xl mb-4">ğŸ¤</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">Kerjasama Peningkatan Mutu Pendidikan</h3>
                        <p class="text-gray-600">Program kerjasama mutu pendidikan</p>
                    </div>
                    
                    <div onclick="showPage('pendampingan-supervisi')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer">
                        <div class="text-4xl mb-4">ğŸ‘¥</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">Pendampingan Supervisi Mutu Pendidikan</h3>
                        <p class="text-gray-600">Layanan supervisi dan pendampingan</p>
                    </div>
                    
                    <div onclick="showPage('permintaan-fasilitator')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer">
                        <div class="text-4xl mb-4">ğŸ¯</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">Permintaan Fasilitator</h3>
                        <p class="text-gray-600">Layanan penyediaan fasilitator</p>
                    </div>
                    
                    <div onclick="showPage('konsultasi-pengaduan')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer">
                        <div class="text-4xl mb-4">ğŸ’¬</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-3">Konsultasi dan Pengaduan</h3>
                        <p class="text-gray-600">Layanan konsultasi dan pengaduan</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Peminjaman Fasilitas Detail Page -->
        <div id="page-peminjaman-fasilitas" class="page-content hidden fade-in">
            <div class="container mx-auto px-4">
                <div class="max-w-4xl mx-auto">
                    <!-- Back Button -->
                    <button onclick="showPage('jenis-layanan')" class="mb-6 flex items-center text-blue-600 hover:text-blue-800 transition-colors">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                        Kembali ke Jenis Layanan
                    </button>
                    
                    <div class="bg-white rounded-3xl shadow-2xl p-8 md:p-12">
                        <div class="text-center mb-8">
                            <div class="text-6xl mb-4">ğŸ¢</div>
                            <h2 class="text-4xl font-bold text-gray-800 mb-4">Layanan Peminjaman Fasilitas</h2>
                        </div>
                        
                        <div class="prose prose-lg max-w-none mb-12">
                            <p class="text-gray-600 leading-relaxed mb-6">
                                Layanan peminjaman fasilitas BPMP Provinsi Maluku tersedia untuk mendukung kegiatan pendidikan dan pelatihan. 
                                Fasilitas yang dapat dipinjam meliputi ruang pertemuan, aula, laboratorium komputer, dan peralatan pendukung lainnya.
                            </p>
                            
                            <p class="text-gray-600 leading-relaxed mb-6">
                                Setiap peminjaman fasilitas dikenakan tarif sesuai dengan Peraturan Penerimaan Negara Bukan Pajak (PNBP) yang berlaku. 
                                Tarif ditetapkan berdasarkan jenis fasilitas, durasi penggunaan, dan tujuan kegiatan.
                            </p>
                            
                            <p class="text-gray-600 leading-relaxed mb-8">
                                Permohonan peminjaman dapat diajukan minimal 7 hari sebelum tanggal penggunaan dengan melengkapi dokumen persyaratan 
                                dan melakukan pembayaran sesuai tarif yang ditetapkan.
                            </p>
                        </div>
                        
                        <!-- Tab Menu -->
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <button onclick="showTab('daftar-tarif')" class="tab-button px-6 py-4 rounded-xl border-2 border-blue-200 text-blue-600 font-medium hover:bg-blue-50 transition-all" id="tab-daftar-tarif">
                                ğŸ’° Daftar Tarif
                            </button>
                            <button onclick="showTab('dokumentasi')" class="tab-button px-6 py-4 rounded-xl border-2 border-blue-200 text-blue-600 font-medium hover:bg-blue-50 transition-all" id="tab-dokumentasi">
                                ğŸ“¸ Dokumentasi Fasilitas
                            </button>
                            <button onclick="showTab('prosedur')" class="tab-button px-6 py-4 rounded-xl border-2 border-blue-200 text-blue-600 font-medium hover:bg-blue-50 transition-all" id="tab-prosedur">
                                ğŸ“‹ Prosedur Peminjaman
                            </button>
                            <button onclick="showTab('formulir')" class="tab-button px-6 py-4 rounded-xl border-2 border-blue-200 text-blue-600 font-medium hover:bg-blue-50 transition-all" id="tab-formulir">
                                ğŸ“ Formulir Peminjaman
                            </button>
                        </div>
                        
                        <!-- Tab Content -->
                        <div id="tab-content" class="mt-8 p-6 bg-gray-50 rounded-2xl">
                            <p class="text-gray-600 text-center">Pilih salah satu menu di atas untuk melihat informasi detail</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Gallery Page -->
        <div id="page-gallery" class="page-content hidden fade-in">
            <div class="container mx-auto px-4">
                <div class="max-w-6xl mx-auto">
                    <!-- Back Button -->
                    <button onclick="backToDocumentation()" class="mb-6 flex items-center text-blue-600 hover:text-blue-800 transition-colors">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                        Kembali ke Dokumentasi Fasilitas
                    </button>
                    
                    <div class="bg-white rounded-3xl shadow-2xl p-8">
                        <div id="gallery-content" class="text-center">
                            <p class="text-gray-600">Memuat galeri...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Permintaan Data dan Informasi Page -->
        <div id="page-permintaan-data" class="page-content hidden fade-in">
            <div class="container mx-auto px-4">
                <div class="max-w-4xl mx-auto">
                    <!-- Back Button -->
                    <button onclick="showPage('jenis-layanan')" class="mb-6 flex items-center text-blue-600 hover:text-blue-800 transition-colors">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                        Kembali ke Jenis Layanan
                    </button>
                    
                    <div class="bg-white rounded-3xl shadow-2xl p-8 md:p-12">
                        <div class="text-center mb-8">
                            <div class="text-6xl mb-4">ğŸ“‹</div>
                            <h2 class="text-4xl font-bold text-gray-800 mb-4">Layanan Permintaan Data dan Informasi</h2>
                        </div>
                        
                        <div class="prose prose-lg max-w-none mb-12">
                            <p class="text-gray-600 leading-relaxed mb-6">
                                Dalam menjalankan peran sebagai Balai penjaminan mutu pendidikan di wilayah, BPMP Provinsi Maluku senantiasa berlandaskan pada kebijakan dan arahan dari Menteri Pendidikan dasar dan Menengah, khususnya terkait program dan kegiatan dalam rangka peningkatan mutu pendidikan dasar dan menengah.
                            </p>
                            
                            <p class="text-gray-600 leading-relaxed mb-6">
                                Sebagai bentuk komitmen dalam pelayanan publik, BPMP turut menyediakan akses terhadap data dan informasi seputar mutu pendidikan kepada pemerintah provinsi, kabupaten/kota, serta seluruh pemangku kepentingan yang membutuhkan.
                            </p>
                            
                            <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-2xl mb-6">
                                <h3 class="text-xl font-bold text-gray-800 mb-4">Layanan ini mencakup antara lain:</h3>
                                <div class="grid md:grid-cols-2 gap-4">
                                    <div class="space-y-2">
                                        <p class="text-gray-700">ğŸ“Œ Revitalisasi Sekolah</p>
                                        <p class="text-gray-700">ğŸ“Œ Digitalisasi Pembelajaran</p>
                                        <p class="text-gray-700">ğŸ“Œ Sistem Penerimaan Murid Baru</p>
                                        <p class="text-gray-700">ğŸ“Œ Wajib Belajar 13 Tahun</p>
                                        <p class="text-gray-700">ğŸ“Œ Penguatan pendidikan karakter</p>
                                    </div>
                                    <div class="space-y-2">
                                        <p class="text-gray-700">ğŸ“Œ Makanan Bergizi Gratis</p>
                                        <p class="text-gray-700">ğŸ“Œ Pembelajaran dan Penilaian</p>
                                        <p class="text-gray-700">ğŸ“Œ Penjaminan Mutu Pendidikan</p>
                                    </div>
                                </div>
                            </div>
                            
                            <p class="text-gray-600 leading-relaxed mb-8">
                                Melalui layanan ini, BPMP berupaya mendorong keterbukaan informasi serta memperkuat pengambilan keputusan berbasis data dalam peningkatan kualitas pendidikan di daerah.
                            </p>
                        </div>
                        
                        <!-- Service Cards -->
                        <div class="grid md:grid-cols-2 gap-8">
                            <div onclick="showDataTab('prosedur')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer border-2 border-blue-100 hover:border-blue-300">
                                <div class="text-4xl mb-4">ğŸ“‹</div>
                                <h3 class="text-xl font-bold text-gray-800 mb-3">Prosedur Pelayanan</h3>
                                <p class="text-gray-600">Lihat prosedur lengkap permintaan data dan informasi</p>
                            </div>
                            
                            <div onclick="showDataTab('formulir')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer border-2 border-purple-100 hover:border-purple-300">
                                <div class="text-4xl mb-4">ğŸ“</div>
                                <h3 class="text-xl font-bold text-gray-800 mb-3">Formulir Pelayanan</h3>
                                <p class="text-gray-600">Isi formulir permintaan data dan informasi</p>
                            </div>
                        </div>
                        
                        <!-- Tab Content -->
                        <div id="data-tab-content" class="mt-8 p-6 bg-gray-50 rounded-2xl hidden">
                            <p class="text-gray-600 text-center">Pilih salah satu menu di atas untuk melihat informasi detail</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Kerjasama Peningkatan Mutu Pendidikan Page -->
        <div id="page-kerjasama-mutu" class="page-content hidden fade-in">
            <div class="container mx-auto px-4">
                <div class="max-w-4xl mx-auto">
                    <!-- Back Button -->
                    <button onclick="showPage('jenis-layanan')" class="mb-6 flex items-center text-blue-600 hover:text-blue-800 transition-colors">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                        Kembali ke Jenis Layanan
                    </button>
                    
                    <div class="bg-white rounded-3xl shadow-2xl p-8 md:p-12">
                        <div class="text-center mb-8">
                            <div class="text-6xl mb-4">ğŸ¤</div>
                            <h2 class="text-4xl font-bold text-gray-800 mb-4">Layanan Kerjasama Peningkatan Mutu Pendidikan</h2>
                        </div>
                        
                        <div class="prose prose-lg max-w-none mb-12">
                            <p class="text-gray-600 leading-relaxed mb-6">
                                Sebagai Unit Pelaksana Teknis Kementerian Pendidikan Dasar dan Menengah di tingkat provinsi, BPMP Provinsi Maluku memiliki salah satu tugas strategis dalam membangun dan mengelola kemitraan di bidang peningkatan mutu pendidikan. Kolaborasi ini dapat dijalin dengan berbagai pemangku kepentingan, baik dari unsur pemerintah daerah, instansi pusat lintas kementerian, maupun masyarakat.
                            </p>
                            
                            <p class="text-gray-600 leading-relaxed mb-6">
                                BPMP konsisten hadir sebagai mitra strategis bagi daerah, khususnya dalam mendukung penyebarluasan informasi dan pelaksanaan program-program peningkatan mutu pendidikan di wilayah Provinsi Maluku.
                            </p>
                            
                            <p class="text-gray-600 leading-relaxed mb-8">
                                Untuk mendukung layanan ini, pemerintah daerah atau pihak terkait dapat mengajukan surat permohonan kemitraan kepada BPMP Provinsi Maluku. Permohonan tersebut akan diproses dan ditindaklanjuti sesuai kebutuhan serta ruang lingkup kerja sama yang diusulkan.
                            </p>
                        </div>
                        
                        <!-- Service Cards -->
                        <div class="grid md:grid-cols-2 gap-8">
                            <div onclick="showKerjasamaTab('prosedur')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer border-2 border-blue-100 hover:border-blue-300">
                                <div class="text-4xl mb-4">ğŸ“‹</div>
                                <h3 class="text-xl font-bold text-gray-800 mb-3">Prosedur Pelayanan</h3>
                                <p class="text-gray-600">Lihat prosedur lengkap kerjasama peningkatan mutu pendidikan</p>
                            </div>
                            
                            <div onclick="showKerjasamaTab('formulir')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer border-2 border-purple-100 hover:border-purple-300">
                                <div class="text-4xl mb-4">ğŸ“</div>
                                <h3 class="text-xl font-bold text-gray-800 mb-3">Formulir Pelayanan</h3>
                                <p class="text-gray-600">Isi formulir kerjasama peningkatan mutu pendidikan</p>
                            </div>
                        </div>
                        
                        <!-- Tab Content -->
                        <div id="kerjasama-tab-content" class="mt-8 p-6 bg-gray-50 rounded-2xl hidden">
                            <p class="text-gray-600 text-center">Pilih salah satu menu di atas untuk melihat informasi detail</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pendampingan Supervisi Mutu Pendidikan Page -->
        <div id="page-pendampingan-supervisi" class="page-content hidden fade-in">
            <div class="container mx-auto px-4">
                <div class="max-w-4xl mx-auto">
                    <!-- Back Button -->
                    <button onclick="showPage('jenis-layanan')" class="mb-6 flex items-center text-blue-600 hover:text-blue-800 transition-colors">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                        Kembali ke Jenis Layanan
                    </button>
                    
                    <div class="bg-white rounded-3xl shadow-2xl p-8 md:p-12">
                        <div class="text-center mb-8">
                            <div class="text-6xl mb-4">ğŸ‘¥</div>
                            <h2 class="text-4xl font-bold text-gray-800 mb-4">Layanan Pendampingan Supervisi Mutu Pendidikan</h2>
                        </div>
                        
                        <div class="prose prose-lg max-w-none mb-12">
                            <p class="text-gray-600 leading-relaxed mb-6">
                                Sebagai Unit Pelaksana Teknis Kementerian Pendidikan Dasar dan Menengah di tingkat provinsi, BPMP Provinsi Maluku memiliki mandat untuk mendukung peningkatan mutu pendidikan melalui kegiatan supervisi dan pendampingan terhadap satuan pendidikan dan pemerintah daerah.
                            </p>
                            
                            <p class="text-gray-600 leading-relaxed mb-6">
                                Pendampingan supervisi mutu pendidikan dilakukan sebagai bagian dari upaya penguatan tata kelola, peningkatan kapasitas, serta pemanfaatan data mutu pendidikan dalam perencanaan dan pengambilan kebijakan berbasis bukti.
                            </p>
                            
                            <p class="text-gray-600 leading-relaxed mb-6">
                                Sejak berdiri, BPMP terus berperan aktif dalam memberikan layanan pendampingan kepada pemerintah daerah guna memastikan program-program peningkatan mutu dapat terlaksana secara efektif dan berkelanjutan di seluruh wilayah Provinsi Maluku.
                            </p>
                            
                            <p class="text-gray-600 leading-relaxed mb-8">
                                Pemerintah daerah atau satuan pendidikan yang memerlukan layanan ini dapat mengajukan surat permohonan pendampingan supervisi mutu pendidikan kepada BPMP Provinsi Maluku. Permohonan akan diproses dan ditindaklanjuti sesuai dengan kebutuhan dan konteks lokal masing-masing daerah.
                            </p>
                        </div>
                        
                        <!-- Service Cards -->
                        <div class="grid md:grid-cols-2 gap-8">
                            <div onclick="showSupervisiTab('prosedur')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer border-2 border-blue-100 hover:border-blue-300">
                                <div class="text-4xl mb-4">ğŸ“‹</div>
                                <h3 class="text-xl font-bold text-gray-800 mb-3">Prosedur Pelayanan</h3>
                                <p class="text-gray-600">Lihat prosedur lengkap pendampingan supervisi mutu pendidikan</p>
                            </div>
                            
                            <div onclick="showSupervisiTab('formulir')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer border-2 border-purple-100 hover:border-purple-300">
                                <div class="text-4xl mb-4">ğŸ“</div>
                                <h3 class="text-xl font-bold text-gray-800 mb-3">Formulir Pelayanan</h3>
                                <p class="text-gray-600">Isi formulir pendampingan supervisi mutu pendidikan</p>
                            </div>
                        </div>
                        
                        <!-- Tab Content -->
                        <div id="supervisi-tab-content" class="mt-8 p-6 bg-gray-50 rounded-2xl hidden">
                            <p class="text-gray-600 text-center">Pilih salah satu menu di atas untuk melihat informasi detail</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Permintaan Fasilitator Page -->
        <div id="page-permintaan-fasilitator" class="page-content hidden fade-in">
            <div class="container mx-auto px-4">
                <div class="max-w-4xl mx-auto">
                    <!-- Back Button -->
                    <button onclick="showPage('jenis-layanan')" class="mb-6 flex items-center text-blue-600 hover:text-blue-800 transition-colors">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                        Kembali ke Jenis Layanan
                    </button>
                    
                    <div class="bg-white rounded-3xl shadow-2xl p-8 md:p-12">
                        <div class="text-center mb-8">
                            <div class="text-6xl mb-4">ğŸ¯</div>
                            <h2 class="text-4xl font-bold text-gray-800 mb-4">Layanan Permintaan Fasilitator</h2>
                        </div>
                        
                        <div class="prose prose-lg max-w-none mb-12">
                            <p class="text-gray-600 leading-relaxed mb-6">
                                Sebagai Unit Pelaksana Teknis Kementerian Pendidikan Dasar dan Menengah di tingkat provinsi, BPMP Provinsi Maluku memiliki sumber daya yang kompeten dan berpengalaman di bidang peningkatan mutu pendidikan. Dalam pelaksanaan tugasnya, BPMP sering diminta untuk memberikan kontribusi melalui kehadiran fasilitator dalam berbagai kegiatan yang diselenggarakan oleh pemerintah daerah, institusi pendidikan, maupun mitra lainnya.
                            </p>
                            
                            <p class="text-gray-600 leading-relaxed mb-6">
                                Hingga saat ini, BPMP Provinsi Maluku terus menunjukkan komitmen dalam mendukung penguatan kapasitas dan penyebarluasan kebijakan pendidikan melalui peran aktif sebagai narasumber, khususnya pada program-program yang berkaitan dengan peningkatan mutu pendidikan di daerah.
                            </p>
                            
                            <p class="text-gray-600 leading-relaxed mb-8">
                                Bagi instansi atau pihak yang memerlukan dukungan fasilitator dari BPMP, dapat mengajukan surat permohonan resmi ke BPMP Provinsi Maluku. Permohonan tersebut akan ditindaklanjuti sesuai dengan kebutuhan, ketersediaan fasilitator, dan kesesuaian topik dengan ruang lingkup tugas BPMP.
                            </p>
                        </div>
                        
                        <!-- Service Cards -->
                        <div class="grid md:grid-cols-2 gap-8">
                            <div onclick="showFasilitatorTab('prosedur')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer border-2 border-blue-100 hover:border-blue-300">
                                <div class="text-4xl mb-4">ğŸ“‹</div>
                                <h3 class="text-xl font-bold text-gray-800 mb-3">Prosedur Pelayanan</h3>
                                <p class="text-gray-600">Lihat prosedur lengkap permintaan fasilitator</p>
                            </div>
                            
                            <div onclick="showFasilitatorTab('formulir')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer border-2 border-purple-100 hover:border-purple-300">
                                <div class="text-4xl mb-4">ğŸ“</div>
                                <h3 class="text-xl font-bold text-gray-800 mb-3">Formulir Pelayanan</h3>
                                <p class="text-gray-600">Isi formulir permintaan fasilitator</p>
                            </div>
                        </div>
                        
                        <!-- Tab Content -->
                        <div id="fasilitator-tab-content" class="mt-8 p-6 bg-gray-50 rounded-2xl hidden">
                            <p class="text-gray-600 text-center">Pilih salah satu menu di atas untuk melihat informasi detail</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Konsultasi dan Pengaduan Page -->
        <div id="page-konsultasi-pengaduan" class="page-content hidden fade-in">
            <div class="container mx-auto px-4">
                <div class="max-w-4xl mx-auto">
                    <!-- Back Button -->
                    <button onclick="showPage('jenis-layanan')" class="mb-6 flex items-center text-blue-600 hover:text-blue-800 transition-colors">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                        Kembali ke Jenis Layanan
                    </button>
                    
                    <div class="bg-white rounded-3xl shadow-2xl p-8 md:p-12">
                        <div class="text-center mb-8">
                            <div class="text-6xl mb-4">ğŸ’¬</div>
                            <h2 class="text-4xl font-bold text-gray-800 mb-4">Layanan Konsultasi dan Pengaduan</h2>
                        </div>
                        
                        <div class="prose prose-lg max-w-none mb-12">
                            <p class="text-gray-600 leading-relaxed mb-6">
                                BPMP Provinsi Maluku menyediakan layanan konsultasi dan pengaduan sebagai bagian dari komitmen dalam memberikan pelayanan publik yang responsif, transparan, dan profesional. Layanan ini dirancang untuk menampung berbagai bentuk konsultasi, keluhan, maupun pengaduan dari masyarakat dan pemangku kepentingan, khususnya terkait pelaksanaan program peningkatan mutu pendidikan.
                            </p>
                            
                            <p class="text-gray-600 leading-relaxed mb-6">
                                Standar pelayanan konsultasi dan pengaduan diterapkan untuk memastikan setiap pertanyaan, masukan, maupun keluhan ditangani secara tepat, cepat, dan memuaskan. Proses penanganan dilakukan oleh petugas layanan yang kompeten dengan mengacu pada prosedur operasional yang jelas dan terukur.
                            </p>
                            
                            <p class="text-gray-600 leading-relaxed mb-6">
                                Pelayanan ini menjadi sarana penting dalam membangun kepercayaan dan kepuasan publik, serta sebagai upaya berkelanjutan dalam meningkatkan kualitas layanan BPMP Provinsi Maluku kepada masyarakat.
                            </p>
                            
                            <p class="text-gray-600 leading-relaxed mb-8">
                                Masyarakat, satuan pendidikan, dan pihak terkait lainnya dapat menyampaikan konsultasi atau pengaduan secara langsung maupun melalui saluran resmi yang disediakan oleh BPMP Provinsi Maluku.
                            </p>
                        </div>
                        
                        <!-- Service Cards -->
                        <div class="grid md:grid-cols-2 gap-8">
                            <div onclick="showKonsultasiTab('prosedur')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer border-2 border-blue-100 hover:border-blue-300">
                                <div class="text-4xl mb-4">ğŸ“‹</div>
                                <h3 class="text-xl font-bold text-gray-800 mb-3">Prosedur Pelayanan</h3>
                                <p class="text-gray-600">Lihat prosedur lengkap konsultasi dan pengaduan</p>
                            </div>
                            
                            <div onclick="showKonsultasiTab('formulir')" class="bg-white p-8 rounded-2xl shadow-lg card-hover cursor-pointer border-2 border-purple-100 hover:border-purple-300">
                                <div class="text-4xl mb-4">ğŸ“</div>
                                <h3 class="text-xl font-bold text-gray-800 mb-3">Formulir Pelayanan</h3>
                                <p class="text-gray-600">Isi formulir konsultasi dan pengaduan</p>
                            </div>
                        </div>
                        
                        <!-- Tab Content -->
                        <div id="konsultasi-tab-content" class="mt-8 p-6 bg-gray-50 rounded-2xl hidden">
                            <p class="text-gray-600 text-center">Pilih salah satu menu di atas untuk melihat informasi detail</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard ULT Page -->
        <div id="page-dashboard-ult" class="page-content hidden fade-in">
            <div class="container mx-auto px-4">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-bold text-gray-800 mb-4">ğŸ“ˆ Dashboard ULT</h2>
                    <p class="text-gray-600 text-lg">Dashboard Unit Layanan Terpadu BPMP Provinsi Maluku</p>
                </div>
                
                <div class="bg-white rounded-3xl shadow-2xl p-6 max-w-7xl mx-auto">
                    <!-- Fallback button jika iframe tidak berfungsi -->
                    <div class="text-center mb-6">
                        <p class="text-gray-600 mb-4">Jika dashboard tidak muncul, klik tombol di bawah ini:</p>
                        <a href="https://www.canva.com/design/DAGwiOh9om8/QpE7jRQk1z0KYsYcKYxlaw/view" 
                           target="_blank" 
                           class="inline-block bg-gradient-to-r from-blue-500 to-purple-600 text-white px-8 py-3 rounded-xl font-semibold hover:from-blue-600 hover:to-purple-700 transition-all duration-300 shadow-lg">
                            ğŸ”— Buka Dashboard di Tab Baru
                        </a>
                    </div>
                    
                    <div class="relative w-full" style="height: 80vh; min-height: 600px;">
                        <iframe src="https://www.canva.com/design/DAGwiOh9om8/QpE7jRQk1z0KYsYcKYxlaw/view?embed" 
                                width="100%" 
                                height="100%" 
                                frameborder="0" 
                                class="rounded-2xl border-0 w-full h-full"
                                allowfullscreen
                                loading="lazy">
                            <div class="text-center p-8">
                                <p class="text-gray-600 mb-4">Dashboard sedang dimuat...</p>
                                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"></div>
                            </div>
                        </iframe>
                    </div>
                </div>
            </div>
        </div>

        <div id="page-hubungi-kami" class="page-content hidden fade-in">
            <div class="container mx-auto px-4">
                <div class="text-center mb-8">
                    <h2 class="text-4xl font-bold text-gray-800 mb-4">ğŸ“ Hubungi Kami</h2>
                    <p class="text-gray-600 text-lg">Informasi kontak dan lokasi BPMP Provinsi Maluku</p>
                </div>
                
                <div class="max-w-6xl mx-auto">
                    <!-- Contact Information Card -->
                    <div class="bg-white rounded-3xl shadow-2xl p-8 md:p-12 mb-8">
                        <div class="grid md:grid-cols-2 gap-12 items-center">
                            <!-- Contact Details -->
                            <div>
                                <div class="mb-8">
                                    <div class="flex items-center space-x-4 mb-6">
                                        <img src="https://i.imgur.com/Q0dFcm7.png" 
                                             alt="Logo BAILEO BPMP Provinsi Maluku" 
                                             class="h-16 w-16 object-contain">
                                        <div>
                                            <h3 class="text-2xl font-bold text-gray-800">BPMP Provinsi Maluku</h3>
                                            <p class="text-gray-600">Balai Penjaminan Mutu Pendidikan</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Contact Information -->
                                <div class="space-y-6">
                                    <div class="flex items-start space-x-4">
                                        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0">
                                            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                            </svg>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-gray-800 mb-1">Alamat</h4>
                                            <p class="text-gray-600 leading-relaxed">
                                                Jl. Tihu Wailela Rumahtiga Ambon<br>
                                                Kota Ambon<br>
                                                Maluku 97233
                                            </p>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-start space-x-4">
                                        <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0">
                                            <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                                            </svg>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-gray-800 mb-1">Email</h4>
                                            <p class="text-gray-600">bpmpmaluku@kemendikdasmen.go.id</p>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-start space-x-4">
                                        <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0">
                                            <svg class="w-6 h-6 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                            </svg>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-gray-800 mb-1">Jam Operasional</h4>
                                            <p class="text-gray-600">
                                                Senin - Kamis: 07:30 - 16:00 WIT<br>
                                                Jumat: 07:30 - 16:30 WIT<br>
                                                Sabtu - Minggu: Tutup
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Contact Image -->
                            <div class="text-center">
                                <div class="bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl p-8">
                                    <img src="https://i.imgur.com/jOCi6Mr.jpg" 
                                         alt="Kontak BPMP Provinsi Maluku" 
                                         class="w-full h-auto max-w-md mx-auto rounded-xl shadow-lg">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quick Contact Actions -->
                    <div class="grid md:grid-cols-3 gap-6 mb-8">
                        <div class="bg-white p-6 rounded-2xl shadow-lg text-center hover:shadow-xl transition-all duration-300">
                            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-2">Kirim Email</h3>
                            <p class="text-gray-600 mb-4">Kirim pertanyaan atau saran melalui email</p>
                            <a href="mailto:bpmpmaluku@kemendikdasmen.go.id" class="inline-block bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors">
                                Kirim Email
                            </a>
                        </div>
                        
                        <div class="bg-white p-6 rounded-2xl shadow-lg text-center hover:shadow-xl transition-all duration-300">
                            <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-2">Chat Langsung</h3>
                            <p class="text-gray-600 mb-4">Chat langsung dengan Tim ULT</p>
                            <button onclick="openLiveChat()" class="inline-block bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                Mulai Chat
                            </button>
                        </div>
                        
                        <div class="bg-white p-6 rounded-2xl shadow-lg text-center hover:shadow-xl transition-all duration-300">
                            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <svg class="w-8 h-8 text-green-600" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-2">Konsultasi via WhatsApp</h3>
                            <p class="text-gray-600 mb-4">Konsultasi langsung melalui WhatsApp</p>
                            <button onclick="openWhatsApp()" class="inline-block bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors">
                                Chat WhatsApp
                            </button>
                        </div>
                        
                        <div class="bg-white p-6 rounded-2xl shadow-lg text-center hover:shadow-xl transition-all duration-300">
                            <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-2">Kunjungi Kantor</h3>
                            <p class="text-gray-600 mb-4">Datang langsung ke kantor kami</p>
                            <a href="https://maps.app.goo.gl/ZixveAj2tDhMeVNP6" 
                               target="_blank" 
                               class="inline-block bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors">
                                Lihat Peta
                            </a>
                        </div>
                    </div>
                    
                    <!-- Social Media Section -->
                    <div class="bg-white rounded-3xl shadow-2xl p-8">
                        <div class="text-center mb-8">
                            <h3 class="text-2xl font-bold text-gray-800 mb-4">ğŸŒ Ikuti Media Sosial Kami</h3>
                            <p class="text-gray-600">Dapatkan informasi terbaru dan update kegiatan BPMP Provinsi Maluku</p>
                        </div>
                        
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                            <!-- Instagram -->
                            <div onclick="openInstagram()" 
                               class="bg-gradient-to-br from-purple-500 to-pink-500 p-6 rounded-2xl shadow-lg text-center hover:shadow-xl transition-all duration-300 hover:transform hover:scale-105 text-white group cursor-pointer">
                                <div class="w-12 h-12 mx-auto mb-3 flex items-center justify-center">
                                    <svg class="w-8 h-8 group-hover:scale-110 transition-transform" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                                    </svg>
                                </div>
                                <h4 class="font-semibold text-sm">Instagram</h4>
                                <p class="text-xs opacity-90 mt-1">@bpmpmaluku</p>
                            </div>
                            
                            <!-- Facebook -->
                            <div onclick="openFacebook()" 
                               class="bg-gradient-to-br from-blue-600 to-blue-700 p-6 rounded-2xl shadow-lg text-center hover:shadow-xl transition-all duration-300 hover:transform hover:scale-105 text-white group cursor-pointer">
                                <div class="w-12 h-12 mx-auto mb-3 flex items-center justify-center">
                                    <svg class="w-8 h-8 group-hover:scale-110 transition-transform" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                                    </svg>
                                </div>
                                <h4 class="font-semibold text-sm">Facebook</h4>
                                <p class="text-xs opacity-90 mt-1">BPMP Maluku</p>
                            </div>
                            
                            <!-- TikTok -->
                            <a href="https://www.tiktok.com/@bpmpmaluku" 
                               target="_blank" 
                               class="bg-gradient-to-br from-gray-800 to-gray-900 p-6 rounded-2xl shadow-lg text-center hover:shadow-xl transition-all duration-300 hover:transform hover:scale-105 text-white group">
                                <div class="w-12 h-12 mx-auto mb-3 flex items-center justify-center">
                                    <svg class="w-8 h-8 group-hover:scale-110 transition-transform" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-.99-.32-2.15-.23-3.02.37-.63.41-1.11 1.04-1.36 1.75-.21.51-.15 1.07-.14 1.61.24 1.64 1.82 3.02 3.5 2.87 1.12-.01 2.19-.66 2.77-1.61.19-.33.4-.67.41-1.06.1-1.79.06-3.57.07-5.36.01-4.03-.01-8.05.02-12.07z"/>
                                    </svg>
                                </div>
                                <h4 class="font-semibold text-sm">TikTok</h4>
                                <p class="text-xs opacity-90 mt-1">@bpmpmaluku</p>
                            </a>
                            
                            <!-- Website -->
                            <a href="http://bpmpmaluku.kemendikdasmen.go.id" 
                               target="_blank" 
                               class="bg-gradient-to-br from-green-600 to-green-700 p-6 rounded-2xl shadow-lg text-center hover:shadow-xl transition-all duration-300 hover:transform hover:scale-105 text-white group">
                                <div class="w-12 h-12 mx-auto mb-3 flex items-center justify-center">
                                    <svg class="w-8 h-8 group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/>
                                    </svg>
                                </div>
                                <h4 class="font-semibold text-sm">Website</h4>
                                <p class="text-xs opacity-90 mt-1">Portal Resmi</p>
                            </a>
                        </div>
                        
                        <div class="mt-8 text-center">
                            <p class="text-gray-600 text-sm">
                                Ikuti akun media sosial kami untuk mendapatkan informasi terbaru tentang program dan kegiatan BPMP Provinsi Maluku
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="page-sippn" class="page-content hidden fade-in">
            <div class="container mx-auto px-4">
                <div class="text-center max-w-2xl mx-auto">
                    <div class="bg-white rounded-3xl shadow-2xl p-12">
                        <div class="text-6xl mb-6">ğŸŒ</div>
                        <h2 class="text-4xl font-bold text-gray-800 mb-6">SIPPN</h2>
                        <p class="text-xl text-gray-600 mb-8">Halaman ini akan segera hadir</p>
                        <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-2xl">
                            <p class="text-blue-700">Sistem Informasi Pelayanan Publik Nasional akan segera dapat diakses melalui platform ini.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200">
        <div class="container mx-auto px-4 py-12">
            <div class="text-center">
                <div class="flex items-center justify-center space-x-4 mb-6">
                    <img src="https://i.imgur.com/Q0dFcm7.png" 
                         alt="Logo BAILEO BPMP Provinsi Maluku" 
                         class="h-12 w-12 object-contain">
                    <div>
                        <h3 class="text-2xl font-bold text-gray-800">BAILEO</h3>
                        <p class="text-gray-600">BPMP Provinsi Maluku</p>
                    </div>
                </div>
                <p class="text-gray-600 mb-4">Bersama Andalkan Informasi Layanan Elektronik Online</p>
                <p class="text-gray-500 text-sm">Â© 2025 BAILEO - BPMP Provinsi Maluku. Semua hak dilindungi.</p>
            </div>
        </div>
    </footer>

    <script>
        // Text-to-Speech function
        function speakText(text) {
            // Stop any ongoing speech
            speechSynthesis.cancel();
            
            // Create new speech utterance
            const utterance = new SpeechSynthesisUtterance(text);
            
            // Set language to Indonesian
            utterance.lang = 'id-ID';
            utterance.rate = 0.9;
            utterance.pitch = 1;
            utterance.volume = 0.8;
            
            // Try to find Indonesian voice
            const voices = speechSynthesis.getVoices();
            const indonesianVoice = voices.find(voice => 
                voice.lang.includes('id') || 
                voice.name.toLowerCase().includes('indonesia') ||
                voice.name.toLowerCase().includes('bahasa')
            );
            
            if (indonesianVoice) {
                utterance.voice = indonesianVoice;
            }
            
            // Speak the text
            speechSynthesis.speak(utterance);
        }

        // Load voices when available
        speechSynthesis.addEventListener('voiceschanged', function() {
            // Voices are now loaded
        });

        // Mobile menu toggle
        document.getElementById('mobile-menu-btn').addEventListener('click', function() {
            const navMenu = document.getElementById('nav-menu');
            navMenu.classList.toggle('hidden');
        });

        function showPage(pageId) {
            // Text-to-speech for page navigation
            const pageTexts = {
                'home': 'Selamat datang di halaman beranda BAILEO',
                'buku-tamu': 'Membuka halaman buku tamu digital',
                'survey': 'Membuka halaman survey kepuasan layanan',
                'jenis-layanan': 'Membuka halaman jenis layanan BPMP',
                'dashboard-ult': 'Membuka dashboard unit layanan terpadu',
                'hubungi-kami': 'Membuka halaman hubungi kami',
                'sippn': 'Membuka halaman sistem informasi pelayanan publik nasional',
                'peminjaman-fasilitas': 'Membuka halaman layanan peminjaman fasilitas',
                'permintaan-data': 'Membuka halaman permintaan data dan informasi',
                'kerjasama-mutu': 'Membuka halaman kerjasama peningkatan mutu pendidikan',
                'pendampingan-supervisi': 'Membuka halaman pendampingan supervisi mutu pendidikan',
                'permintaan-fasilitator': 'Membuka halaman permintaan fasilitator',
                'konsultasi-pengaduan': 'Membuka halaman konsultasi dan pengaduan'
            };
            
            if (pageTexts[pageId]) {
                speakText(pageTexts[pageId]);
            }
            
            // Hide all pages
            const pages = document.querySelectorAll('.page-content');
            pages.forEach(page => {
                page.classList.add('hidden');
                page.classList.remove('fade-in');
            });
            
            // Remove active class from all nav items
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.classList.remove('active-nav');
            });
            
            // Show selected page
            const targetPage = document.getElementById(`page-${pageId}`);
            if (targetPage) {
                targetPage.classList.remove('hidden');
                setTimeout(() => {
                    targetPage.classList.add('fade-in');
                }, 10);
            }
            
            // Add active class to clicked nav item
            const activeNav = document.getElementById(`nav-${pageId}`);
            if (activeNav) {
                activeNav.classList.add('active-nav');
            }

            // Initialize dashboard when dashboard page is shown
            if (pageId === 'dashboard-ult') {
                setTimeout(() => {
                    loadUserData();
                    initializeDashboardStats();
                }, 500);
            }



            // Hide mobile menu after selection
            const navMenu = document.getElementById('nav-menu');
            if (window.innerWidth < 768) {
                navMenu.classList.add('hidden');
            }
        }

        function showPeminjamanFasilitas() {
            showPage('peminjaman-fasilitas');
        }

        function showGallery(facilityType) {
            // Text-to-speech for gallery
            const galleryTexts = {
                'aula': 'Membuka galeri foto aula',
                'ruang-kelas': 'Membuka galeri foto ruang kelas',
                'penginapan': 'Membuka galeri foto penginapan'
            };
            
            if (galleryTexts[facilityType]) {
                speakText(galleryTexts[facilityType]);
            }
            
            // Hide all pages
            const pages = document.querySelectorAll('.page-content');
            pages.forEach(page => {
                page.classList.add('hidden');
                page.classList.remove('fade-in');
            });
            
            // Show gallery page
            const galleryPage = document.getElementById('page-gallery');
            galleryPage.classList.remove('hidden');
            setTimeout(() => {
                galleryPage.classList.add('fade-in');
            }, 10);
            
            // Update gallery content
            const galleryContent = document.getElementById('gallery-content');
            let content = '';
            
            switch(facilityType) {
                case 'aula':
                    content = `
                        <div class="text-center mb-8">
                            <div class="text-6xl mb-4">ğŸ­</div>
                            <h2 class="text-4xl font-bold text-gray-800 mb-4">Galeri Aula</h2>
                            <p class="text-gray-600 text-lg">Fasilitas aula yang tersedia untuk acara besar</p>
                        </div>
                        
                        <!-- Photo Gallery Grid -->
                        <div class="grid md:grid-cols-2 gap-6 mb-8">
                            <!-- Photo 1 -->
                            <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                                <img src="https://i.imgur.com/7QRsIHy.jpg" 
                                     alt="Aula BPMP Provinsi Maluku - Tampak Depan" 
                                     class="w-full h-auto object-contain">
                            </div>
                            
                            <!-- Photo 2 -->
                            <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                                <img src="https://i.imgur.com/eyjQK7J.jpg" 
                                     alt="Aula BPMP Provinsi Maluku - Interior" 
                                     class="w-full h-auto object-contain">
                            </div>
                            
                            <!-- Photo 3 -->
                            <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                                <img src="https://i.imgur.com/klELjxc.jpg" 
                                     alt="Aula BPMP Provinsi Maluku - Panggung" 
                                     class="w-full h-auto object-contain">
                            </div>
                            
                            <!-- Photo 4 -->
                            <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                                <img src="https://i.imgur.com/z7dhXET.jpg" 
                                     alt="Aula BPMP Provinsi Maluku - Suasana Acara" 
                                     class="w-full h-auto object-contain">
                            </div>
                        </div>
                    `;
                    break;
                case 'ruang-kelas':
                    content = `
                        <div class="text-center mb-8">
                            <div class="text-6xl mb-4">ğŸ«</div>
                            <h2 class="text-4xl font-bold text-gray-800 mb-4">Galeri Ruang Kelas</h2>
                            <p class="text-gray-600 text-lg">Ruang kelas modern untuk kegiatan pembelajaran</p>
                        </div>
                        
                        <!-- Photo Gallery Grid -->
                        <div class="grid md:grid-cols-2 gap-6 mb-8">
                            <!-- Photo 1 -->
                            <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                                <img src="https://i.imgur.com/Rk7Qd4I.jpg" 
                                     alt="Ruang Kelas BPMP - Fasilitas Modern" 
                                     class="w-full h-auto object-contain">
                            </div>
                            
                            <!-- Photo 2 -->
                            <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                                <img src="https://i.imgur.com/Ntt9pA1.jpg" 
                                     alt="Ruang Kelas BPMP - Area Diskusi" 
                                     class="w-full h-auto object-contain">
                            </div>
                            
                            <!-- Photo 3 -->
                            <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                                <img src="https://i.imgur.com/QrPof8L.jpg" 
                                     alt="Ruang Kelas BPMP - Peralatan Pembelajaran" 
                                     class="w-full h-auto object-contain">
                            </div>
                            
                            <!-- Photo 4 -->
                            <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                                <img src="https://i.imgur.com/GqoQfJz.jpg" 
                                     alt="Ruang Kelas BPMP - Aktivitas Pelatihan" 
                                     class="w-full h-auto object-contain">
                            </div>
                        </div>
                    `;
                    break;
                case 'penginapan':
                    content = `
                        <div class="text-center mb-8">
                            <div class="text-6xl mb-4">ğŸ¨</div>
                            <h2 class="text-4xl font-bold text-gray-800 mb-4">Galeri Penginapan</h2>
                            <p class="text-gray-600 text-lg">Fasilitas penginapan yang nyaman untuk tamu</p>
                        </div>
                        
                        <!-- Photo Gallery Grid -->
                        <div class="grid md:grid-cols-2 gap-6 mb-8">
                            <!-- Photo 1 -->
                            <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                                <img src="https://i.imgur.com/MMmpl3S.jpg" 
                                     alt="Penginapan BPMP - Kamar Tamu" 
                                     class="w-full h-auto object-contain">
                            </div>
                            
                            <!-- Photo 2 -->
                            <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                                <img src="https://i.imgur.com/2TIVUXy.jpg" 
                                     alt="Penginapan BPMP - Fasilitas Kamar" 
                                     class="w-full h-auto object-contain">
                            </div>
                            
                            <!-- Photo 3 -->
                            <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                                <img src="https://i.imgur.com/DxMdbM8.jpg" 
                                     alt="Penginapan BPMP - Area Istirahat" 
                                     class="w-full h-auto object-contain">
                            </div>
                            
                            <!-- Photo 4 -->
                            <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                                <img src="https://i.imgur.com/VtKw5Gc.jpg" 
                                     alt="Penginapan BPMP - Suasana Penginapan" 
                                     class="w-full h-auto object-contain">
                            </div>
                        </div>
                    `;
                    break;
            }
            
            galleryContent.innerHTML = content;
        }

        function backToDocumentation() {
            showPage('peminjaman-fasilitas');
            // Automatically show documentation tab
            setTimeout(() => {
                showTab('dokumentasi');
            }, 100);
        }

        function showDataTab(tabId) {
            // Text-to-speech for data tabs
            const tabTexts = {
                'prosedur': 'Menampilkan prosedur permintaan data dan informasi',
                'formulir': 'Menampilkan formulir permintaan data dan informasi'
            };
            
            if (tabTexts[tabId]) {
                speakText(tabTexts[tabId]);
            }
            
            // Show tab content
            const content = document.getElementById('data-tab-content');
            content.classList.remove('hidden');
            
            let tabContent = '';
            
            switch(tabId) {
                case 'prosedur':
                    tabContent = `
                        <h3 class="text-2xl font-bold text-gray-800 mb-6">ğŸ“‹ Prosedur Permintaan Data dan Informasi</h3>
                        
                        <!-- Flowchart Prosedur -->
                        <div class="mb-8">
                            <div class="text-center mb-6">
                                <p class="text-gray-600 mb-4">Alur prosedur permintaan data dan informasi BPMP Provinsi Maluku:</p>
                            </div>
                            
                            <!-- SVG Flowchart -->
                            <div class="bg-white rounded-2xl shadow-lg p-8 overflow-x-auto">
                                <svg viewBox="0 0 600 800" class="w-full h-auto max-w-2xl mx-auto" style="min-height: 700px;">
                                    <!-- Definitions for arrows -->
                                    <defs>
                                        <marker id="arrowhead2" markerWidth="10" markerHeight="7" 
                                                refX="9" refY="3.5" orient="auto">
                                            <polygon points="0 0, 10 3.5, 0 7" fill="#374151" />
                                        </marker>
                                    </defs>
                                    
                                    <!-- 1. Start Oval -->
                                    <ellipse cx="300" cy="60" rx="180" ry="35" 
                                             fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="300" y="55" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        Pengguna layanan menyampaikan
                                    </text>
                                    <text x="300" y="70" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        surat permohonan data dan informasi
                                    </text>
                                    
                                    <!-- Arrow 1 -->
                                    <line x1="300" y1="95" x2="300" y2="135" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead2)"/>
                                    
                                    <!-- 2. Process Rectangle -->
                                    <rect x="180" y="150" width="240" height="60" rx="8" 
                                          fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="300" y="175" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        Surat diterima
                                    </text>
                                    <text x="300" y="195" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        BPMP Provinsi Maluku
                                    </text>
                                    
                                    <!-- Arrow 2 -->
                                    <line x1="300" y1="210" x2="300" y2="270" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead2)"/>
                                    
                                    <!-- 3. Koordinasi Text -->
                                    <text x="300" y="245" text-anchor="middle" class="text-sm font-medium fill-gray-600">
                                        Koordinasi
                                    </text>
                                    
                                    <!-- 4. Decision Diamond -->
                                    <polygon points="300,285 380,335 300,385 220,335" 
                                             fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="300" y="330" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        Dapat
                                    </text>
                                    <text x="300" y="345" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        diberikan?
                                    </text>
                                    
                                    <!-- Left Branch - Ya -->
                                    <line x1="220" y1="335" x2="150" y2="335" 
                                          stroke="#374151" stroke-width="2"/>
                                    <line x1="150" y1="335" x2="150" y2="480" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead2)"/>
                                    <text x="185" y="330" text-anchor="middle" class="text-sm font-semibold fill-green-600">
                                        Ya
                                    </text>
                                    
                                    <!-- Right Branch - Tidak -->
                                    <line x1="380" y1="335" x2="450" y2="335" 
                                          stroke="#374151" stroke-width="2"/>
                                    <line x1="450" y1="335" x2="450" y2="480" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead2)"/>
                                    <text x="415" y="330" text-anchor="middle" class="text-sm font-semibold fill-red-600">
                                        Tidak
                                    </text>
                                    
                                    <!-- 5. Left Result Oval (Approved) -->
                                    <ellipse cx="150" cy="530" rx="120" ry="45" 
                                             fill="#dcfce7" stroke="#16a34a" stroke-width="2"/>
                                    <text x="150" y="520" text-anchor="middle" class="text-sm font-medium fill-green-800">
                                        Pengguna layanan
                                    </text>
                                    <text x="150" y="535" text-anchor="middle" class="text-sm font-medium fill-green-800">
                                        menerima data dan informasi
                                    </text>
                                    <text x="150" y="550" text-anchor="middle" class="text-sm font-medium fill-green-800">
                                        yang diminta
                                    </text>
                                    
                                    <!-- 6. Right Result Oval (Rejected) -->
                                    <ellipse cx="450" cy="530" rx="120" ry="45" 
                                             fill="#fecaca" stroke="#dc2626" stroke-width="2"/>
                                    <text x="450" y="520" text-anchor="middle" class="text-sm font-medium fill-red-800">
                                        Pengguna layanan menerima
                                    </text>
                                    <text x="450" y="535" text-anchor="middle" class="text-sm font-medium fill-red-800">
                                        konfirmasi penolakan
                                    </text>
                                    <text x="450" y="550" text-anchor="middle" class="text-sm font-medium fill-red-800">
                                        pemberian data dan informasi
                                    </text>
                                </svg>
                                
                                <div class="text-center mt-6">
                                    <p class="text-gray-500 text-sm">Flowchart Prosedur Permintaan Data dan Informasi BPMP Provinsi Maluku</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Penjelasan Prosedur -->
                        <div class="bg-gray-50 rounded-2xl p-6">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“ Persyaratan Dokumen:</h4>
                            <div class="space-y-3">
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">1</div>
                                    <p class="text-gray-700">Surat permohonan resmi dari instansi/lembaga</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">2</div>
                                    <p class="text-gray-700">Identitas pemohon (KTP/Kartu Identitas)</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">3</div>
                                    <p class="text-gray-700">Spesifikasi data dan informasi yang dibutuhkan</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">4</div>
                                    <p class="text-gray-700">Tujuan penggunaan data dan informasi</p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'formulir':
                    tabContent = `
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">ğŸ“ Formulir Permintaan Data dan Informasi</h3>
                        <p class="text-gray-600 mb-6">Silakan isi formulir permintaan data dan informasi di bawah ini:</p>
                        
                        <!-- Fallback button jika iframe tidak berfungsi -->
                        <div class="text-center mb-6">
                            <p class="text-gray-600 mb-4">Jika form tidak muncul, klik tombol di bawah ini:</p>
                            <a href="https://docs.google.com/forms/d/e/1FAIpQLSdF7HG5DQiSYaQrQ0jm2Yo6lAc5WbN3g52mvGSxQGbZNb8U0Q/viewform" 
                               target="_blank" 
                               class="inline-block bg-gradient-to-r from-blue-500 to-purple-600 text-white px-8 py-3 rounded-xl font-semibold hover:from-blue-600 hover:to-purple-700 transition-all duration-300 shadow-lg">
                                ğŸ”— Buka Formulir di Tab Baru
                            </a>
                        </div>
                        
                        <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                            <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSdF7HG5DQiSYaQrQ0jm2Yo6lAc5WbN3g52mvGSxQGbZNb8U0Q/viewform?usp=pp_url&embedded=true" 
                                    width="100%" 
                                    height="1200" 
                                    frameborder="0" 
                                    marginheight="0" 
                                    marginwidth="0"
                                    class="rounded-2xl border-0"
                                    sandbox="allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox"
                                    loading="lazy">
                                <div class="text-center p-8">
                                    <p class="text-gray-600 mb-4">Form sedang dimuat...</p>
                                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"></div>
                                </div>
                            </iframe>
                        </div>
                    `;
                    break;
            }
            
            content.innerHTML = tabContent;
        }

        function showKerjasamaTab(tabId) {
            // Text-to-speech for cooperation tabs
            const tabTexts = {
                'prosedur': 'Menampilkan prosedur kerjasama peningkatan mutu pendidikan',
                'formulir': 'Menampilkan formulir kerjasama peningkatan mutu pendidikan'
            };
            
            if (tabTexts[tabId]) {
                speakText(tabTexts[tabId]);
            }
            
            // Show tab content
            const content = document.getElementById('kerjasama-tab-content');
            content.classList.remove('hidden');
            
            let tabContent = '';
            
            switch(tabId) {
                case 'prosedur':
                    tabContent = `
                        <h3 class="text-2xl font-bold text-gray-800 mb-6">ğŸ“‹ Prosedur Kerjasama Peningkatan Mutu Pendidikan</h3>
                        
                        <!-- Flowchart Prosedur -->
                        <div class="mb-8">
                            <div class="text-center mb-6">
                                <p class="text-gray-600 mb-4">Alur prosedur kerjasama peningkatan mutu pendidikan BPMP Provinsi Maluku:</p>
                            </div>
                            
                            <!-- SVG Flowchart -->
                            <div class="bg-white rounded-2xl shadow-lg p-8 overflow-x-auto">
                                <svg viewBox="0 0 600 800" class="w-full h-auto max-w-2xl mx-auto" style="min-height: 700px;">
                                    <!-- Definitions for arrows -->
                                    <defs>
                                        <marker id="arrowhead3" markerWidth="10" markerHeight="7" 
                                                refX="9" refY="3.5" orient="auto">
                                            <polygon points="0 0, 10 3.5, 0 7" fill="#374151" />
                                        </marker>
                                    </defs>
                                    
                                    <!-- 1. Start Oval -->
                                    <ellipse cx="300" cy="60" rx="180" ry="35" 
                                             fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="300" y="55" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        Pengguna layanan menyampaikan
                                    </text>
                                    <text x="300" y="70" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        surat permohonan dan proposal kerjasama
                                    </text>
                                    
                                    <!-- Arrow 1 -->
                                    <line x1="300" y1="95" x2="300" y2="135" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead3)"/>
                                    
                                    <!-- 2. Process Rectangle -->
                                    <rect x="180" y="150" width="240" height="60" rx="8" 
                                          fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="300" y="175" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        Surat diterima
                                    </text>
                                    <text x="300" y="195" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        BPMP Provinsi Maluku
                                    </text>
                                    
                                    <!-- Arrow 2 -->
                                    <line x1="300" y1="210" x2="300" y2="270" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead3)"/>
                                    
                                    <!-- 3. Koordinasi Text -->
                                    <text x="300" y="245" text-anchor="middle" class="text-sm font-medium fill-gray-600">
                                        Koordinasi
                                    </text>
                                    
                                    <!-- 4. Decision Diamond -->
                                    <polygon points="300,285 380,335 300,385 220,335" 
                                             fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="300" y="330" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        Dapat
                                    </text>
                                    <text x="300" y="345" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        dilakukan?
                                    </text>
                                    
                                    <!-- Left Branch - Ya -->
                                    <line x1="220" y1="335" x2="150" y2="335" 
                                          stroke="#374151" stroke-width="2"/>
                                    <line x1="150" y1="335" x2="150" y2="480" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead3)"/>
                                    <text x="185" y="330" text-anchor="middle" class="text-sm font-semibold fill-green-600">
                                        Ya
                                    </text>
                                    
                                    <!-- Right Branch - Tidak -->
                                    <line x1="380" y1="335" x2="450" y2="335" 
                                          stroke="#374151" stroke-width="2"/>
                                    <line x1="450" y1="335" x2="450" y2="480" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead3)"/>
                                    <text x="415" y="330" text-anchor="middle" class="text-sm font-semibold fill-red-600">
                                        Tidak
                                    </text>
                                    
                                    <!-- 5. Left Result Oval (Approved) -->
                                    <ellipse cx="150" cy="530" rx="120" ry="45" 
                                             fill="#dcfce7" stroke="#16a34a" stroke-width="2"/>
                                    <text x="150" y="520" text-anchor="middle" class="text-sm font-medium fill-green-800">
                                        MoU antara BPMP Provinsi Maluku
                                    </text>
                                    <text x="150" y="535" text-anchor="middle" class="text-sm font-medium fill-green-800">
                                        dengan pengguna layanan
                                    </text>
                                    
                                    <!-- 6. Right Result Oval (Rejected) -->
                                    <ellipse cx="450" cy="530" rx="120" ry="45" 
                                             fill="#fecaca" stroke="#dc2626" stroke-width="2"/>
                                    <text x="450" y="520" text-anchor="middle" class="text-sm font-medium fill-red-800">
                                        Pengguna layanan menerima
                                    </text>
                                    <text x="450" y="535" text-anchor="middle" class="text-sm font-medium fill-red-800">
                                        konfirmasi penolakan
                                    </text>
                                    <text x="450" y="550" text-anchor="middle" class="text-sm font-medium fill-red-800">
                                        proposal kerjasama
                                    </text>
                                </svg>
                                
                                <div class="text-center mt-6">
                                    <p class="text-gray-500 text-sm">Flowchart Prosedur Kerjasama Peningkatan Mutu Pendidikan BPMP Provinsi Maluku</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Penjelasan Prosedur -->
                        <div class="bg-gray-50 rounded-2xl p-6">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“ Persyaratan Dokumen:</h4>
                            <div class="space-y-3">
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">1</div>
                                    <p class="text-gray-700">Surat permohonan kerjasama resmi dari instansi/lembaga</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">2</div>
                                    <p class="text-gray-700">Proposal kerjasama yang detail dan terstruktur</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">3</div>
                                    <p class="text-gray-700">Profil instansi/lembaga pengusul</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">4</div>
                                    <p class="text-gray-700">Rencana kegiatan dan timeline pelaksanaan</p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'formulir':
                    tabContent = `
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">ğŸ“ Formulir Kerjasama Peningkatan Mutu Pendidikan</h3>
                        <p class="text-gray-600 mb-6">Silakan isi formulir kerjasama peningkatan mutu pendidikan di bawah ini:</p>
                        
                        <!-- Fallback button jika iframe tidak berfungsi -->
                        <div class="text-center mb-6">
                            <p class="text-gray-600 mb-4">Jika form tidak muncul, klik tombol di bawah ini:</p>
                            <a href="https://docs.google.com/forms/d/e/1FAIpQLSf5MSmU9SqRDEvBqyBMTjIA_9o7yqxinepzvxt5dzY5C8lnwQ/viewform" 
                               target="_blank" 
                               class="inline-block bg-gradient-to-r from-blue-500 to-purple-600 text-white px-8 py-3 rounded-xl font-semibold hover:from-blue-600 hover:to-purple-700 transition-all duration-300 shadow-lg">
                                ğŸ”— Buka Formulir di Tab Baru
                            </a>
                        </div>
                        
                        <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                            <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSf5MSmU9SqRDEvBqyBMTjIA_9o7yqxinepzvxt5dzY5C8lnwQ/viewform?usp=pp_url&embedded=true" 
                                    width="100%" 
                                    height="1200" 
                                    frameborder="0" 
                                    marginheight="0" 
                                    marginwidth="0"
                                    class="rounded-2xl border-0"
                                    sandbox="allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox"
                                    loading="lazy">
                                <div class="text-center p-8">
                                    <p class="text-gray-600 mb-4">Form sedang dimuat...</p>
                                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"></div>
                                </div>
                            </iframe>
                        </div>
                    `;
                    break;
            }
            
            content.innerHTML = tabContent;
        }

        function showSupervisiTab(tabId) {
            // Text-to-speech for supervision tabs
            const tabTexts = {
                'prosedur': 'Menampilkan prosedur pendampingan supervisi mutu pendidikan',
                'formulir': 'Menampilkan formulir pendampingan supervisi mutu pendidikan'
            };
            
            if (tabTexts[tabId]) {
                speakText(tabTexts[tabId]);
            }
            
            // Show tab content
            const content = document.getElementById('supervisi-tab-content');
            content.classList.remove('hidden');
            
            let tabContent = '';
            
            switch(tabId) {
                case 'prosedur':
                    tabContent = `
                        <h3 class="text-2xl font-bold text-gray-800 mb-6">ğŸ“‹ Prosedur Pendampingan Supervisi Mutu Pendidikan</h3>
                        
                        <!-- Flowchart Prosedur -->
                        <div class="mb-8">
                            <div class="text-center mb-6">
                                <p class="text-gray-600 mb-4">Alur prosedur pendampingan supervisi mutu pendidikan BPMP Provinsi Maluku:</p>
                            </div>
                            
                            <!-- SVG Flowchart -->
                            <div class="bg-white rounded-2xl shadow-lg p-8 overflow-x-auto">
                                <svg viewBox="0 0 600 800" class="w-full h-auto max-w-2xl mx-auto" style="min-height: 700px;">
                                    <!-- Definitions for arrows -->
                                    <defs>
                                        <marker id="arrowhead4" markerWidth="10" markerHeight="7" 
                                                refX="9" refY="3.5" orient="auto">
                                            <polygon points="0 0, 10 3.5, 0 7" fill="#374151" />
                                        </marker>
                                    </defs>
                                    
                                    <!-- 1. Start Oval -->
                                    <ellipse cx="300" cy="60" rx="180" ry="35" 
                                             fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="300" y="55" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        Pengguna layanan menyampaikan
                                    </text>
                                    <text x="300" y="70" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        surat permohonan pendampingan supervisi
                                    </text>
                                    
                                    <!-- Arrow 1 -->
                                    <line x1="300" y1="95" x2="300" y2="135" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead4)"/>
                                    
                                    <!-- 2. Process Rectangle -->
                                    <rect x="180" y="150" width="240" height="60" rx="8" 
                                          fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="300" y="175" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        Surat diterima
                                    </text>
                                    <text x="300" y="195" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        BPMP Provinsi Maluku
                                    </text>
                                    
                                    <!-- Arrow 2 -->
                                    <line x1="300" y1="210" x2="300" y2="270" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead4)"/>
                                    
                                    <!-- 3. Koordinasi Text -->
                                    <text x="300" y="245" text-anchor="middle" class="text-sm font-medium fill-gray-600">
                                        Koordinasi
                                    </text>
                                    
                                    <!-- 4. Decision Diamond -->
                                    <polygon points="300,285 380,335 300,385 220,335" 
                                             fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="300" y="330" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        Dapat
                                    </text>
                                    <text x="300" y="345" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        dilakukan?
                                    </text>
                                    
                                    <!-- Left Branch - Ya -->
                                    <line x1="220" y1="335" x2="150" y2="335" 
                                          stroke="#374151" stroke-width="2"/>
                                    <line x1="150" y1="335" x2="150" y2="480" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead4)"/>
                                    <text x="185" y="330" text-anchor="middle" class="text-sm font-semibold fill-green-600">
                                        Ya
                                    </text>
                                    
                                    <!-- Right Branch - Tidak -->
                                    <line x1="380" y1="335" x2="450" y2="335" 
                                          stroke="#374151" stroke-width="2"/>
                                    <line x1="450" y1="335" x2="450" y2="480" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead4)"/>
                                    <text x="415" y="330" text-anchor="middle" class="text-sm font-semibold fill-red-600">
                                        Tidak
                                    </text>
                                    
                                    <!-- 5. Left Result Oval (Approved) -->
                                    <ellipse cx="150" cy="530" rx="120" ry="45" 
                                             fill="#dcfce7" stroke="#16a34a" stroke-width="2"/>
                                    <text x="150" y="520" text-anchor="middle" class="text-sm font-medium fill-green-800">
                                        Pengguna layanan
                                    </text>
                                    <text x="150" y="535" text-anchor="middle" class="text-sm font-medium fill-green-800">
                                        menerima pendampingan
                                    </text>
                                    <text x="150" y="550" text-anchor="middle" class="text-sm font-medium fill-green-800">
                                        supervisi
                                    </text>
                                    
                                    <!-- 6. Right Result Oval (Rejected) -->
                                    <ellipse cx="450" cy="530" rx="120" ry="45" 
                                             fill="#fecaca" stroke="#dc2626" stroke-width="2"/>
                                    <text x="450" y="520" text-anchor="middle" class="text-sm font-medium fill-red-800">
                                        Pengguna layanan menerima
                                    </text>
                                    <text x="450" y="535" text-anchor="middle" class="text-sm font-medium fill-red-800">
                                        konfirmasi penolakan
                                    </text>
                                    <text x="450" y="550" text-anchor="middle" class="text-sm font-medium fill-red-800">
                                        pendampingan supervisi
                                    </text>
                                </svg>
                                
                                <div class="text-center mt-6">
                                    <p class="text-gray-500 text-sm">Flowchart Prosedur Pendampingan Supervisi Mutu Pendidikan BPMP Provinsi Maluku</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Penjelasan Prosedur -->
                        <div class="bg-gray-50 rounded-2xl p-6">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“ Persyaratan Dokumen:</h4>
                            <div class="space-y-3">
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">1</div>
                                    <p class="text-gray-700">Surat permohonan pendampingan supervisi resmi dari instansi/lembaga</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">2</div>
                                    <p class="text-gray-700">Profil satuan pendidikan atau pemerintah daerah</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">3</div>
                                    <p class="text-gray-700">Identifikasi kebutuhan pendampingan supervisi</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">4</div>
                                    <p class="text-gray-700">Rencana jadwal dan target capaian</p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'formulir':
                    tabContent = `
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">ğŸ“ Formulir Pendampingan Supervisi Mutu Pendidikan</h3>
                        <p class="text-gray-600 mb-6">Silakan isi formulir pendampingan supervisi mutu pendidikan di bawah ini:</p>
                        
                        <!-- Fallback button jika iframe tidak berfungsi -->
                        <div class="text-center mb-6">
                            <p class="text-gray-600 mb-4">Jika form tidak muncul, klik tombol di bawah ini:</p>
                            <a href="https://docs.google.com/forms/d/e/1FAIpQLSeVFHSscCqPsMZ64X8HToN7jpMqwz7InNuJ283eN6CbMSfoAg/viewform" 
                               target="_blank" 
                               class="inline-block bg-gradient-to-r from-blue-500 to-purple-600 text-white px-8 py-3 rounded-xl font-semibold hover:from-blue-600 hover:to-purple-700 transition-all duration-300 shadow-lg">
                                ğŸ”— Buka Formulir di Tab Baru
                            </a>
                        </div>
                        
                        <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                            <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSeVFHSscCqPsMZ64X8HToN7jpMqwz7InNuJ283eN6CbMSfoAg/viewform?usp=pp_url&embedded=true" 
                                    width="100%" 
                                    height="1200" 
                                    frameborder="0" 
                                    marginheight="0" 
                                    marginwidth="0"
                                    class="rounded-2xl border-0"
                                    sandbox="allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox"
                                    loading="lazy">
                                <div class="text-center p-8">
                                    <p class="text-gray-600 mb-4">Form sedang dimuat...</p>
                                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"></div>
                                </div>
                            </iframe>
                        </div>
                    `;
                    break;
            }
            
            content.innerHTML = tabContent;
        }

        function showFasilitatorTab(tabId) {
            // Text-to-speech for facilitator tabs
            const tabTexts = {
                'prosedur': 'Menampilkan prosedur permintaan fasilitator',
                'formulir': 'Menampilkan formulir permintaan fasilitator'
            };
            
            if (tabTexts[tabId]) {
                speakText(tabTexts[tabId]);
            }
            
            // Show tab content
            const content = document.getElementById('fasilitator-tab-content');
            content.classList.remove('hidden');
            
            let tabContent = '';
            
            switch(tabId) {
                case 'prosedur':
                    tabContent = `
                        <h3 class="text-2xl font-bold text-gray-800 mb-6">ğŸ“‹ Sistem Mekanisme dan Prosedur Pelayanan â€“ Standar Pelayanan Permintaan Fasilitator</h3>
                        
                        <!-- Flowchart Prosedur -->
                        <div class="mb-8">
                            <div class="text-center mb-6">
                                <p class="text-gray-600 mb-4">Alur prosedur permintaan fasilitator BPMP Provinsi Maluku:</p>
                            </div>
                            
                            <!-- SVG Flowchart -->
                            <div class="bg-white rounded-2xl shadow-lg p-8 overflow-x-auto">
                                <svg viewBox="0 0 600 1000" class="w-full h-auto max-w-2xl mx-auto" style="min-height: 900px;">
                                    <!-- Definitions for arrows -->
                                    <defs>
                                        <marker id="arrowhead5" markerWidth="10" markerHeight="7" 
                                                refX="9" refY="3.5" orient="auto">
                                            <polygon points="0 0, 10 3.5, 0 7" fill="#374151" />
                                        </marker>
                                    </defs>
                                    
                                    <!-- 1. Start Oval (Red) -->
                                    <ellipse cx="300" cy="60" rx="180" ry="35" 
                                             fill="#fecaca" stroke="#dc2626" stroke-width="2"/>
                                    <text x="300" y="55" text-anchor="middle" class="text-sm font-medium fill-red-800">
                                        Pengajuan Surat Resmi
                                    </text>
                                    <text x="300" y="70" text-anchor="middle" class="text-sm font-medium fill-red-800">
                                        Kepada Kepala BPMP setempat
                                    </text>
                                    
                                    <!-- Arrow 1 -->
                                    <line x1="300" y1="95" x2="300" y2="135" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead5)"/>
                                    
                                    <!-- 2. Decision Diamond (Yellow) -->
                                    <polygon points="300,150 420,220 300,290 180,220" 
                                             fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
                                    <text x="300" y="200" text-anchor="middle" class="text-xs font-medium fill-yellow-800">
                                        Kepala BPMP mendisposisi surat
                                    </text>
                                    <text x="300" y="215" text-anchor="middle" class="text-xs font-medium fill-yellow-800">
                                        permohonan fasilitator ke Kepala
                                    </text>
                                    <text x="300" y="230" text-anchor="middle" class="text-xs font-medium fill-yellow-800">
                                        Bagian Tata Usaha yang relevan untuk
                                    </text>
                                    <text x="300" y="245" text-anchor="middle" class="text-xs font-medium fill-yellow-800">
                                        menugaskan pejabat atau tenaga
                                    </text>
                                    <text x="300" y="260" text-anchor="middle" class="text-xs font-medium fill-yellow-800">
                                        fungsional sesuai substansi
                                    </text>
                                    <text x="300" y="275" text-anchor="middle" class="text-xs font-medium fill-yellow-800">
                                        permohonan dan kompetensi
                                    </text>
                                    
                                    <!-- Left Branch - Tidak -->
                                    <line x1="180" y1="220" x2="100" y2="220" 
                                          stroke="#374151" stroke-width="2"/>
                                    <line x1="100" y1="220" x2="100" y2="150" 
                                          stroke="#374151" stroke-width="2"/>
                                    <line x1="100" y1="150" x2="120" y2="150" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead5)"/>
                                    <text x="140" y="215" text-anchor="middle" class="text-sm font-semibold fill-red-600">
                                        Tidak
                                    </text>
                                    
                                    <!-- Right Branch - Ya -->
                                    <line x1="420" y1="220" x2="500" y2="220" 
                                          stroke="#374151" stroke-width="2"/>
                                    <line x1="500" y1="220" x2="500" y2="350" 
                                          stroke="#374151" stroke-width="2"/>
                                    <line x1="500" y1="350" x2="420" y2="350" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead5)"/>
                                    <text x="460" y="215" text-anchor="middle" class="text-sm font-semibold fill-green-600">
                                        Ya
                                    </text>
                                    
                                    <!-- 3. Process Rectangle 1 (Light Blue) -->
                                    <rect x="180" y="320" width="240" height="60" rx="8" 
                                          fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
                                    <text x="300" y="340" text-anchor="middle" class="text-sm font-medium fill-blue-800">
                                        Kepala Sub Bagian Umum membuat
                                    </text>
                                    <text x="300" y="355" text-anchor="middle" class="text-sm font-medium fill-blue-800">
                                        surat tugas sebagai fasilitator
                                    </text>
                                    <text x="300" y="370" text-anchor="middle" class="text-sm font-medium fill-blue-800">
                                        ditandatangani Kepala BPMP
                                    </text>
                                    
                                    <!-- Arrow 2 -->
                                    <line x1="300" y1="380" x2="300" y2="420" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead5)"/>
                                    
                                    <!-- 4. Process Rectangle 2 (Light Blue) -->
                                    <rect x="180" y="435" width="240" height="80" rx="8" 
                                          fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
                                    <text x="300" y="455" text-anchor="middle" class="text-sm font-medium fill-blue-800">
                                        BPMP menyampaikan konfirmasi
                                    </text>
                                    <text x="300" y="470" text-anchor="middle" class="text-sm font-medium fill-blue-800">
                                        ketersediaan narasumber/fasilitator
                                    </text>
                                    <text x="300" y="485" text-anchor="middle" class="text-sm font-medium fill-blue-800">
                                        melalui telepon/surat
                                    </text>
                                    <text x="300" y="500" text-anchor="middle" class="text-sm font-medium fill-blue-800">
                                        kepada pemohon
                                    </text>
                                    
                                    <!-- Arrow 3 -->
                                    <line x1="300" y1="515" x2="300" y2="555" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead5)"/>
                                    
                                    <!-- 5. End Oval (Red) -->
                                    <ellipse cx="300" cy="590" rx="120" ry="35" 
                                             fill="#fecaca" stroke="#dc2626" stroke-width="2"/>
                                    <text x="300" y="585" text-anchor="middle" class="text-sm font-medium fill-red-800">
                                        Fasilitator
                                    </text>
                                    <text x="300" y="600" text-anchor="middle" class="text-sm font-medium fill-red-800">
                                        melaksanakan tugas
                                    </text>
                                </svg>
                                
                                <div class="text-center mt-6">
                                    <p class="text-gray-500 text-sm">Flowchart Sistem Mekanisme dan Prosedur Pelayanan â€“ Standar Pelayanan Permintaan Fasilitator</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Penjelasan Prosedur -->
                        <div class="bg-gray-50 rounded-2xl p-6">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“ Persyaratan Dokumen:</h4>
                            <div class="space-y-3">
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">1</div>
                                    <p class="text-gray-700">Surat permohonan resmi dari instansi/lembaga kepada Kepala BPMP</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">2</div>
                                    <p class="text-gray-700">Spesifikasi topik dan substansi yang dibutuhkan</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">3</div>
                                    <p class="text-gray-700">Jadwal dan lokasi kegiatan yang jelas</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">4</div>
                                    <p class="text-gray-700">Profil kegiatan dan target peserta</p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'formulir':
                    tabContent = `
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">ğŸ“ Formulir Permintaan Fasilitator</h3>
                        <p class="text-gray-600 mb-6">Silakan isi formulir permintaan fasilitator di bawah ini:</p>
                        
                        <!-- Fallback button jika iframe tidak berfungsi -->
                        <div class="text-center mb-6">
                            <p class="text-gray-600 mb-4">Jika form tidak muncul, klik tombol di bawah ini:</p>
                            <a href="https://docs.google.com/forms/d/e/1FAIpQLSfI7n0d_HHO28YOYuViTsfzuSsp50pdP7R6Am-x03LsTDCAvg/viewform" 
                               target="_blank" 
                               class="inline-block bg-gradient-to-r from-blue-500 to-purple-600 text-white px-8 py-3 rounded-xl font-semibold hover:from-blue-600 hover:to-purple-700 transition-all duration-300 shadow-lg">
                                ğŸ”— Buka Formulir di Tab Baru
                            </a>
                        </div>
                        
                        <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                            <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSfI7n0d_HHO28YOYuViTsfzuSsp50pdP7R6Am-x03LsTDCAvg/viewform?usp=pp_url&embedded=true" 
                                    width="100%" 
                                    height="1200" 
                                    frameborder="0" 
                                    marginheight="0" 
                                    marginwidth="0"
                                    class="rounded-2xl border-0"
                                    sandbox="allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox"
                                    loading="lazy">
                                <div class="text-center p-8">
                                    <p class="text-gray-600 mb-4">Form sedang dimuat...</p>
                                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"></div>
                                </div>
                            </iframe>
                        </div>
                    `;
                    break;
            }
            
            content.innerHTML = tabContent;
        }

        function showKonsultasiTab(tabId) {
            // Text-to-speech for consultation tabs
            const tabTexts = {
                'prosedur': 'Menampilkan prosedur konsultasi dan pengaduan',
                'formulir': 'Menampilkan formulir konsultasi dan pengaduan'
            };
            
            if (tabTexts[tabId]) {
                speakText(tabTexts[tabId]);
            }
            
            // Show tab content
            const content = document.getElementById('konsultasi-tab-content');
            content.classList.remove('hidden');
            
            let tabContent = '';
            
            switch(tabId) {
                case 'prosedur':
                    tabContent = `
                        <h3 class="text-2xl font-bold text-gray-800 mb-6">ğŸ“‹ Prosedur Konsultasi dan Pengaduan</h3>
                        
                        <!-- Flowchart Prosedur -->
                        <div class="mb-8">
                            <div class="text-center mb-6">
                                <p class="text-gray-600 mb-4">Alur prosedur konsultasi dan pengaduan BPMP Provinsi Maluku:</p>
                            </div>
                            
                            <!-- SVG Flowchart -->
                            <div class="bg-white rounded-2xl shadow-lg p-8 overflow-x-auto">
                                <svg viewBox="0 0 600 1200" class="w-full h-auto max-w-2xl mx-auto" style="min-height: 1100px;">
                                    <!-- Definitions for arrows -->
                                    <defs>
                                        <marker id="arrowhead6" markerWidth="10" markerHeight="7" 
                                                refX="9" refY="3.5" orient="auto">
                                            <polygon points="0 0, 10 3.5, 0 7" fill="#374151" />
                                        </marker>
                                    </defs>
                                    
                                    <!-- 1. Start Oval -->
                                    <ellipse cx="300" cy="60" rx="150" ry="35" 
                                             fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="300" y="55" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        Pengguna layanan
                                    </text>
                                    <text x="300" y="70" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        menyampaikan pengaduan
                                    </text>
                                    
                                    <!-- Arrow 1 -->
                                    <line x1="300" y1="95" x2="300" y2="135" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead6)"/>
                                    
                                    <!-- 2. Process Rectangle -->
                                    <rect x="180" y="150" width="240" height="60" rx="8" 
                                          fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="300" y="175" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        Pengaduan diterima
                                    </text>
                                    <text x="300" y="195" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        BPMP Provinsi Maluku
                                    </text>
                                    
                                    <!-- Arrow 2 -->
                                    <line x1="300" y1="210" x2="300" y2="270" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead6)"/>
                                    
                                    <!-- 3. Decision Diamond 1 -->
                                    <polygon points="300,285 380,335 300,385 220,335" 
                                             fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="300" y="330" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        Verifikasi dan/atau
                                    </text>
                                    <text x="300" y="345" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        menindaklanjuti
                                    </text>
                                    
                                    <!-- Arrow 3 -->
                                    <line x1="300" y1="385" x2="300" y2="445" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead6)"/>
                                    
                                    <!-- 4. Decision Diamond 2 -->
                                    <polygon points="300,460 380,510 300,560 220,510" 
                                             fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="300" y="505" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        Dapat diselesaikan
                                    </text>
                                    <text x="300" y="520" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        BPMP
                                    </text>
                                    
                                    <!-- Right Branch - Tidak -->
                                    <line x1="380" y1="510" x2="450" y2="510" 
                                          stroke="#374151" stroke-width="2"/>
                                    <line x1="450" y1="510" x2="450" y2="590" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead6)"/>
                                    <text x="415" y="505" text-anchor="middle" class="text-sm font-semibold fill-red-600">
                                        Tidak
                                    </text>
                                    
                                    <!-- Left Branch - Ya -->
                                    <line x1="220" y1="510" x2="150" y2="510" 
                                          stroke="#374151" stroke-width="2"/>
                                    <line x1="150" y1="510" x2="150" y2="1050" 
                                          stroke="#374151" stroke-width="2"/>
                                    <line x1="150" y1="1050" x2="220" y2="1050" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead6)"/>
                                    <text x="185" y="505" text-anchor="middle" class="text-sm font-semibold fill-green-600">
                                        Ya
                                    </text>
                                    
                                    <!-- 5. Process Rectangle 1 -->
                                    <rect x="350" y="605" width="200" height="60" rx="8" 
                                          fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="450" y="625" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        BPMP menyerahkan laporan
                                    </text>
                                    <text x="450" y="640" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        yang sudah terverifikasi
                                    </text>
                                    <text x="450" y="655" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        ke BKLM
                                    </text>
                                    
                                    <!-- Arrow 4 -->
                                    <line x1="450" y1="665" x2="450" y2="705" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead6)"/>
                                    
                                    <!-- 6. Process Rectangle 2 -->
                                    <rect x="350" y="720" width="200" height="80" rx="8" 
                                          fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="450" y="740" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        BKLM menyerahkan laporan
                                    </text>
                                    <text x="450" y="755" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        ke Itjen dan unit kerja
                                    </text>
                                    <text x="450" y="770" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        terkait untuk
                                    </text>
                                    <text x="450" y="785" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        ditindaklanjuti
                                    </text>
                                    
                                    <!-- Arrow 5 -->
                                    <line x1="450" y1="800" x2="450" y2="840" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead6)"/>
                                    
                                    <!-- 7. Process Rectangle 3 -->
                                    <rect x="350" y="855" width="200" height="60" rx="8" 
                                          fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="450" y="875" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        BKLM menerima laporan
                                    </text>
                                    <text x="450" y="895" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        tindak lanjut
                                    </text>
                                    
                                    <!-- Arrow 6 -->
                                    <line x1="450" y1="915" x2="450" y2="955" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead6)"/>
                                    
                                    <!-- 8. Process Rectangle 4 -->
                                    <rect x="350" y="970" width="200" height="60" rx="8" 
                                          fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="450" y="990" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        BKLM menyerahkan laporan
                                    </text>
                                    <text x="450" y="1005" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        tindak lanjut ke BPMP
                                    </text>
                                    
                                    <!-- Arrow 7 -->
                                    <line x1="450" y1="1030" x2="450" y2="1050" 
                                          stroke="#374151" stroke-width="2"/>
                                    <line x1="450" y1="1050" x2="380" y2="1050" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead6)"/>
                                    
                                    <!-- 9. End Oval (Green) -->
                                    <ellipse cx="300" cy="1080" rx="180" ry="45" 
                                             fill="#dcfce7" stroke="#16a34a" stroke-width="2"/>
                                    <text x="300" y="1065" text-anchor="middle" class="text-sm font-medium fill-green-800">
                                        Pengguna layanan menerima
                                    </text>
                                    <text x="300" y="1080" text-anchor="middle" class="text-sm font-medium fill-green-800">
                                        laporan hasil verifikasi atau
                                    </text>
                                    <text x="300" y="1095" text-anchor="middle" class="text-sm font-medium fill-green-800">
                                        tindak lanjut pengaduan
                                    </text>
                                </svg>
                                
                                <div class="text-center mt-6">
                                    <p class="text-gray-500 text-sm">Flowchart Prosedur Konsultasi dan Pengaduan BPMP Provinsi Maluku</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Penjelasan Prosedur -->
                        <div class="bg-gray-50 rounded-2xl p-6">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“ Persyaratan Dokumen:</h4>
                            <div class="space-y-3">
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">1</div>
                                    <p class="text-gray-700">Identitas lengkap pengadu (nama, alamat, nomor telepon)</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">2</div>
                                    <p class="text-gray-700">Uraian lengkap masalah atau pengaduan</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">3</div>
                                    <p class="text-gray-700">Bukti pendukung (jika ada)</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">4</div>
                                    <p class="text-gray-700">Harapan penyelesaian dari pengadu</p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'formulir':
                    tabContent = `
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">ğŸ“ Formulir Konsultasi dan Pengaduan</h3>
                        <p class="text-gray-600 mb-6">Silakan isi formulir konsultasi dan pengaduan di bawah ini:</p>
                        
                        <!-- Fallback button jika iframe tidak berfungsi -->
                        <div class="text-center mb-6">
                            <p class="text-gray-600 mb-4">Jika form tidak muncul, klik tombol di bawah ini:</p>
                            <a href="https://docs.google.com/forms/d/e/1FAIpQLSfYt1otT9I5AHvB0P2lBDg311qHGNxXAlwicHAXKYzm6cdzlQ/viewform" 
                               target="_blank" 
                               class="inline-block bg-gradient-to-r from-blue-500 to-purple-600 text-white px-8 py-3 rounded-xl font-semibold hover:from-blue-600 hover:to-purple-700 transition-all duration-300 shadow-lg">
                                ğŸ”— Buka Formulir di Tab Baru
                            </a>
                        </div>
                        
                        <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                            <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSfYt1otT9I5AHvB0P2lBDg311qHGNxXAlwicHAXKYzm6cdzlQ/viewform?usp=pp_url&embedded=true" 
                                    width="100%" 
                                    height="1200" 
                                    frameborder="0" 
                                    marginheight="0" 
                                    marginwidth="0"
                                    class="rounded-2xl border-0"
                                    sandbox="allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox"
                                    loading="lazy">
                                <div class="text-center p-8">
                                    <p class="text-gray-600 mb-4">Form sedang dimuat...</p>
                                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"></div>
                                </div>
                            </iframe>
                        </div>
                    `;
                    break;
            }
            
            content.innerHTML = tabContent;
        }

        function showTab(tabId) {
            // Text-to-speech for tabs
            const tabTexts = {
                'daftar-tarif': 'Menampilkan daftar tarif peminjaman fasilitas',
                'dokumentasi': 'Menampilkan dokumentasi fasilitas yang tersedia',
                'prosedur': 'Menampilkan prosedur peminjaman fasilitas',
                'formulir': 'Menampilkan formulir peminjaman fasilitas'
            };
            
            if (tabTexts[tabId]) {
                speakText(tabTexts[tabId]);
            }
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab-button');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Add active class to clicked tab
            document.getElementById(`tab-${tabId}`).classList.add('active');
            
            // Update tab content
            const content = document.getElementById('tab-content');
            let tabContent = '';
            
            switch(tabId) {
                case 'daftar-tarif':
                    tabContent = `
                        <h3 class="text-2xl font-bold text-gray-800 mb-6">ğŸ’° Daftar Tarif Peminjaman Fasilitas</h3>
                        
                        <!-- Penginapan Section -->
                        <div class="mb-8">
                            <h4 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                                <span class="text-2xl mr-2">ğŸ¨</span>
                                Tarif Penginapan
                            </h4>
                            <div class="grid md:grid-cols-3 gap-6">
                                <!-- Penginapan Anggrek -->
                                <div class="bg-gradient-to-br from-purple-50 to-pink-50 p-6 rounded-xl border-2 border-purple-200">
                                    <div class="text-center mb-4">
                                        <div class="text-3xl mb-2">ğŸŒº</div>
                                        <h5 class="text-lg font-bold text-purple-800">Penginapan Anggrek</h5>
                                    </div>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center bg-white p-3 rounded-lg">
                                            <span class="text-gray-700 font-medium">Kamar AC</span>
                                            <span class="text-purple-600 font-bold">Rp 175.000 / hari</span>
                                        </div>
                                        <div class="flex justify-between items-center bg-white p-3 rounded-lg">
                                            <span class="text-gray-700 font-medium">Kamar Non AC</span>
                                            <span class="text-purple-600 font-bold">Rp 150.000 / hari</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Penginapan Bougenville -->
                                <div class="bg-gradient-to-br from-pink-50 to-red-50 p-6 rounded-xl border-2 border-pink-200">
                                    <div class="text-center mb-4">
                                        <div class="text-3xl mb-2">ğŸŒ¸</div>
                                        <h5 class="text-lg font-bold text-pink-800">Penginapan Bougenville</h5>
                                    </div>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center bg-white p-3 rounded-lg">
                                            <span class="text-gray-700 font-medium">Kamar AC</span>
                                            <span class="text-pink-600 font-bold">Rp 150.000 / hari</span>
                                        </div>
                                        <div class="flex justify-between items-center bg-white p-3 rounded-lg">
                                            <span class="text-gray-700 font-medium">Kamar Non AC</span>
                                            <span class="text-pink-600 font-bold">Rp 125.000 / hari</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Penginapan Flamboyan -->
                                <div class="bg-gradient-to-br from-orange-50 to-red-50 p-6 rounded-xl border-2 border-orange-200">
                                    <div class="text-center mb-4">
                                        <div class="text-3xl mb-2">ğŸŒº</div>
                                        <h5 class="text-lg font-bold text-orange-800">Penginapan Flamboyan</h5>
                                    </div>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center bg-white p-3 rounded-lg">
                                            <span class="text-gray-700 font-medium">Kamar AC</span>
                                            <span class="text-orange-600 font-bold">Rp 207.000 / hari</span>
                                        </div>
                                        <div class="bg-gray-100 p-3 rounded-lg text-center">
                                            <span class="text-gray-500 text-sm">Kamar Non AC tidak tersedia</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Fasilitas Lainnya Section -->
                        <div>
                            <h4 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                                <span class="text-2xl mr-2">ğŸ¢</span>
                                Tarif Fasilitas Lainnya
                            </h4>
                            <div class="grid md:grid-cols-2 gap-6">
                                <div class="bg-white p-6 rounded-xl shadow-lg border-2 border-green-100">
                                    <h5 class="font-semibold text-gray-800 mb-2">Aula</h5>
                                    <p class="text-green-600 font-bold">Rp 2.055.000 / hari</p>
                                </div>
                                <div class="bg-white p-6 rounded-xl shadow-lg border-2 border-yellow-100">
                                    <h5 class="font-semibold text-gray-800 mb-2">Ruang Kelas</h5>
                                    <p class="text-yellow-600 font-bold">Rp 259.000 / hari</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Catatan -->
                        <div class="mt-8 bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <span class="text-blue-400 text-xl">â„¹ï¸</span>
                                </div>
                                <div class="ml-3">
                                    <p class="text-sm text-blue-700">
                                        <strong>Catatan:</strong> Tarif di atas berlaku per malam untuk penginapan dan per hari untuk fasilitas lainnya. 
                                        Tarif dapat berubah sewaktu-waktu sesuai dengan ketentuan yang berlaku.
                                    </p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'dokumentasi':
                    tabContent = `
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">ğŸ“¸ Dokumentasi Fasilitas</h3>
                        <p class="text-gray-600 mb-4">Klik pada fasilitas untuk melihat galeri foto:</p>
                        <div class="grid md:grid-cols-3 gap-6">
                            <div onclick="showGallery('aula')" class="bg-white p-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer hover:transform hover:scale-105 text-center">
                                <div class="text-5xl mb-4">ğŸ­</div>
                                <h4 class="text-lg font-semibold text-gray-800 mb-2">Aula</h4>
                                <p class="text-gray-600 text-sm">Lihat galeri foto aula</p>
                            </div>
                            <div onclick="showGallery('ruang-kelas')" class="bg-white p-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer hover:transform hover:scale-105 text-center">
                                <div class="text-5xl mb-4">ğŸ«</div>
                                <h4 class="text-lg font-semibold text-gray-800 mb-2">Ruang Kelas</h4>
                                <p class="text-gray-600 text-sm">Lihat galeri foto ruang kelas</p>
                            </div>
                            <div onclick="showGallery('penginapan')" class="bg-white p-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer hover:transform hover:scale-105 text-center">
                                <div class="text-5xl mb-4">ğŸ¨</div>
                                <h4 class="text-lg font-semibold text-gray-800 mb-2">Penginapan</h4>
                                <p class="text-gray-600 text-sm">Lihat galeri foto penginapan</p>
                            </div>
                        </div>
                    `;
                    break;
                case 'prosedur':
                    tabContent = `
                        <h3 class="text-2xl font-bold text-gray-800 mb-6">ğŸ“‹ Prosedur Peminjaman</h3>
                        
                        <!-- Flowchart Prosedur Peminjaman -->
                        <div class="mb-8">
                            <div class="text-center mb-6">
                                <p class="text-gray-600 mb-4">Alur prosedur peminjaman fasilitas BPMP Provinsi Maluku:</p>
                            </div>
                            
                            <!-- SVG Flowchart Vertikal -->
                            <div class="bg-white rounded-2xl shadow-lg p-8 overflow-x-auto">
                                <svg viewBox="0 0 600 800" class="w-full h-auto max-w-2xl mx-auto" style="min-height: 700px;">
                                    <!-- Definitions for arrows -->
                                    <defs>
                                        <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                                                refX="9" refY="3.5" orient="auto">
                                            <polygon points="0 0, 10 3.5, 0 7" fill="#374151" />
                                        </marker>
                                    </defs>
                                    
                                    <!-- 1. Start Oval -->
                                    <ellipse cx="300" cy="60" rx="180" ry="35" 
                                             fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="300" y="55" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        Pengguna layanan menyampaikan
                                    </text>
                                    <text x="300" y="70" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        surat permohonan penggunaan fasilitas
                                    </text>
                                    
                                    <!-- Arrow 1 -->
                                    <line x1="300" y1="95" x2="300" y2="135" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
                                    
                                    <!-- 2. Process Rectangle -->
                                    <rect x="180" y="150" width="240" height="60" rx="8" 
                                          fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="300" y="175" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        Surat diterima
                                    </text>
                                    <text x="300" y="195" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        BPMP Provinsi Maluku
                                    </text>
                                    
                                    <!-- Arrow 2 -->
                                    <line x1="300" y1="210" x2="300" y2="270" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
                                    
                                    <!-- 3. Koordinasi Text -->
                                    <text x="300" y="245" text-anchor="middle" class="text-sm font-medium fill-gray-600">
                                        Koordinasi
                                    </text>
                                    
                                    <!-- 4. Decision Diamond -->
                                    <polygon points="300,285 380,335 300,385 220,335" 
                                             fill="white" stroke="#374151" stroke-width="2"/>
                                    <text x="300" y="330" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        Dapat
                                    </text>
                                    <text x="300" y="345" text-anchor="middle" class="text-sm font-medium fill-gray-800">
                                        digunakan?
                                    </text>
                                    
                                    <!-- Left Branch - Ya -->
                                    <line x1="220" y1="335" x2="150" y2="335" 
                                          stroke="#374151" stroke-width="2"/>
                                    <line x1="150" y1="335" x2="150" y2="480" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
                                    <text x="185" y="330" text-anchor="middle" class="text-sm font-semibold fill-green-600">
                                        Ya
                                    </text>
                                    
                                    <!-- Right Branch - Tidak -->
                                    <line x1="380" y1="335" x2="450" y2="335" 
                                          stroke="#374151" stroke-width="2"/>
                                    <line x1="450" y1="335" x2="450" y2="480" 
                                          stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
                                    <text x="415" y="330" text-anchor="middle" class="text-sm font-semibold fill-red-600">
                                        Tidak
                                    </text>
                                    
                                    <!-- 5. Left Result Oval (Approved) -->
                                    <ellipse cx="150" cy="530" rx="120" ry="45" 
                                             fill="#dcfce7" stroke="#16a34a" stroke-width="2"/>
                                    <text x="150" y="520" text-anchor="middle" class="text-sm font-medium fill-green-800">
                                        Pengguna layanan
                                    </text>
                                    <text x="150" y="535" text-anchor="middle" class="text-sm font-medium fill-green-800">
                                        menerima konfirmasi
                                    </text>
                                    <text x="150" y="550" text-anchor="middle" class="text-sm font-medium fill-green-800">
                                        penggunaan fasilitas
                                    </text>
                                    
                                    <!-- 6. Right Result Oval (Rejected) -->
                                    <ellipse cx="450" cy="530" rx="120" ry="45" 
                                             fill="#fecaca" stroke="#dc2626" stroke-width="2"/>
                                    <text x="450" y="520" text-anchor="middle" class="text-sm font-medium fill-red-800">
                                        Pengguna layanan
                                    </text>
                                    <text x="450" y="535" text-anchor="middle" class="text-sm font-medium fill-red-800">
                                        menerima konfirmasi
                                    </text>
                                    <text x="450" y="550" text-anchor="middle" class="text-sm font-medium fill-red-800">
                                        penolakan penggunaan fasilitas
                                    </text>
                                </svg>
                                
                                <div class="text-center mt-6">
                                    <p class="text-gray-500 text-sm">Flowchart Prosedur Peminjaman Fasilitas BPMP Provinsi Maluku</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Penjelasan Prosedur -->
                        <div class="bg-gray-50 rounded-2xl p-6">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“ Penjelasan Prosedur:</h4>
                            <div class="space-y-3">
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">1</div>
                                    <p class="text-gray-700">Pengguna layanan mengajukan surat permohonan penggunaan fasilitas ke BPMP Provinsi Maluku</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">2</div>
                                    <p class="text-gray-700">BPMP menerima dan memproses surat permohonan</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600">3</div>
                                    <p class="text-gray-700">Tim melakukan koordinasi internal untuk menentukan ketersediaan fasilitas</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-green-100 rounded-full flex items-center justify-center text-xs font-semibold text-green-600">âœ“</div>
                                    <p class="text-gray-700"><span class="font-semibold text-green-600">Jika disetujui:</span> Pengguna menerima konfirmasi penggunaan fasilitas</p>
                                </div>
                                <div class="flex items-start space-x-3">
                                    <div class="w-6 h-6 bg-red-100 rounded-full flex items-center justify-center text-xs font-semibold text-red-600">âœ—</div>
                                    <p class="text-gray-700"><span class="font-semibold text-red-600">Jika ditolak:</span> Pengguna menerima konfirmasi penolakan dengan alasan</p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'formulir':
                    tabContent = `
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">ğŸ“ Formulir Peminjaman Fasilitas</h3>
                        <p class="text-gray-600 mb-6">Silakan isi formulir peminjaman fasilitas di bawah ini:</p>
                        
                        <!-- Fallback button jika iframe tidak berfungsi -->
                        <div class="text-center mb-6">
                            <p class="text-gray-600 mb-4">Jika form tidak muncul, klik tombol di bawah ini:</p>
                            <a href="https://docs.google.com/forms/d/e/1FAIpQLSdtkdJ9CsTdUkPCuAkCblIQD53e6IM5xfrLpbpnasvjhx9JrQ/viewform" 
                               target="_blank" 
                               class="inline-block bg-gradient-to-r from-blue-500 to-purple-600 text-white px-8 py-3 rounded-xl font-semibold hover:from-blue-600 hover:to-purple-700 transition-all duration-300 shadow-lg">
                                ğŸ”— Buka Formulir di Tab Baru
                            </a>
                        </div>
                        
                        <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                            <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSdtkdJ9CsTdUkPCuAkCblIQD53e6IM5xfrLpbpnasvjhx9JrQ/viewform?usp=pp_url&embedded=true" 
                                    width="100%" 
                                    height="800" 
                                    frameborder="0" 
                                    marginheight="0" 
                                    marginwidth="0"
                                    class="rounded-2xl border-0"
                                    sandbox="allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox"
                                    loading="lazy">
                                <div class="text-center p-8">
                                    <p class="text-gray-600 mb-4">Form sedang dimuat...</p>
                                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"></div>
                                </div>
                            </iframe>
                        </div>
                    `;
                    break;
            }
            
            content.innerHTML = tabContent;
        }



        // User Dashboard functionality
        let serviceTypeChart, statusChart;
        let userData = [];
        let filteredData = [];
        let currentPage = 1;
        let recordsPerPage = 10;

        // Load user data from Google Sheets CSV
        async function loadUserData() {
            try {
                showLoading();
                
                // Try multiple CSV URLs in case one fails
                const csvUrls = [
                    'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ7FD5ngYHAbf8swSc4D_1BAObZtgxftSzJTHMJZ8LMc4ImsgDvzbE-xLu7wNRumPYFUVopmV5ou_HE/pub?output=csv',
                    'https://docs.google.com/spreadsheets/d/1vQ7FD5ngYHAbf8swSc4D_1BAObZtgxftSzJTHMJZ8LMc4ImsgDvzbE-xLu7wNRumPYFUVopmV5ou_HE/export?format=csv'
                ];
                
                let csvText = null;
                let lastError = null;
                
                // Try each URL
                for (const url of csvUrls) {
                    try {
                        const response = await fetch(url, {
                            method: 'GET',
                            headers: {
                                'Accept': 'text/csv,text/plain,*/*'
                            }
                        });
                        
                        if (response.ok) {
                            csvText = await response.text();
                            if (csvText && csvText.trim().length > 0) {
                                break;
                            }
                        }
                    } catch (err) {
                        lastError = err;
                        console.warn('Failed to fetch from URL:', url, err);
                    }
                }
                
                // If no CSV data was loaded, use sample data
                if (!csvText || csvText.trim().length === 0) {
                    console.warn('Using sample data due to CSV loading failure');
                    userData = generateSampleData();
                } else {
                    userData = parseCSV(csvText);
                }
                
                // Ensure we have some data
                if (userData.length === 0) {
                    userData = generateSampleData();
                }
                
                filteredData = [...userData];
                
                updateDashboardMetrics();
                initializeUserCharts();
                populateFilters();
                renderTable();
                showDashboard();
                
                showNotification('Data berhasil dimuat!', 'success');
            } catch (error) {
                console.error('Error loading data:', error);
                
                // Fallback to sample data
                userData = generateSampleData();
                filteredData = [...userData];
                
                updateDashboardMetrics();
                initializeUserCharts();
                populateFilters();
                renderTable();
                showDashboard();
                
                showNotification('Menggunakan data contoh karena gagal memuat data dari server', 'warning');
            }
        }

        // Generate sample data for demonstration
        function generateSampleData() {
            const sampleData = [];
            const names = [
                'Ahmad Rizki', 'Siti Nurhaliza', 'Budi Santoso', 'Dewi Sartika', 'Eko Prasetyo',
                'Fatimah Zahra', 'Gunawan Wijaya', 'Hesti Purnamasari', 'Indra Kusuma', 'Joko Widodo',
                'Kartika Sari', 'Lukman Hakim', 'Maya Sari', 'Nanda Pratama', 'Oki Setiana',
                'Putri Ayu', 'Qori Sumantri', 'Rina Marlina', 'Sandi Permana', 'Tuti Handayani'
            ];
            
            const institutions = [
                'SMAN 1 Ambon', 'SMPN 5 Tual', 'SDN 10 Masohi', 'SMK Negeri 2 Namlea',
                'Universitas Pattimura', 'IAIN Ambon', 'Politeknik Negeri Ambon',
                'Dinas Pendidikan Maluku', 'Dinas Pendidikan Kota Ambon', 'LPMP Maluku',
                'Kantor Wilayah Kemenag Maluku', 'Balai Diklat Keagamaan Ambon'
            ];
            
            const serviceTypes = [
                'Buku Tamu', 'Survey Kepuasan', 'Konsultasi & Pengaduan', 
                'Peminjaman Fasilitas', 'Permintaan Data & Informasi', 
                'Kerjasama', 'Supervisi', 'Fasilitator'
            ];
            
            const statuses = ['Selesai', 'Diproses', 'Menunggu'];
            const statusWeights = [0.7, 0.2, 0.1];
            
            for (let i = 0; i < 50; i++) {
                const randomDate = new Date();
                randomDate.setDate(randomDate.getDate() - Math.floor(Math.random() * 30));
                
                // Weighted random status selection
                const random = Math.random();
                let status = statuses[0];
                let sum = 0;
                for (let j = 0; j < statusWeights.length; j++) {
                    sum += statusWeights[j];
                    if (random <= sum) {
                        status = statuses[j];
                        break;
                    }
                }
                
                sampleData.push({
                    id: i + 1,
                    'Timestamp': randomDate.toISOString(),
                    'Nama Lengkap': names[Math.floor(Math.random() * names.length)],
                    'Instansi/Lembaga': institutions[Math.floor(Math.random() * institutions.length)],
                    'Jenis Layanan': serviceTypes[Math.floor(Math.random() * serviceTypes.length)],
                    'Nomor Telepon': `081${Math.floor(Math.random() * 100000000).toString().padStart(8, '0')}`,
                    'Email': `user${i + 1}@example.com`,
                    status: status
                });
            }
            
            return sampleData;
        }

        function parseCSV(csvText) {
            const lines = csvText.trim().split('\n');
            const headers = lines[0].split(',').map(h => h.replace(/"/g, '').trim());
            
            return lines.slice(1).map((line, index) => {
                const values = [];
                let current = '';
                let inQuotes = false;
                
                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    if (char === '"') {
                        inQuotes = !inQuotes;
                    } else if (char === ',' && !inQuotes) {
                        values.push(current.trim());
                        current = '';
                    } else {
                        current += char;
                    }
                }
                values.push(current.trim());
                
                const row = {};
                headers.forEach((header, i) => {
                    row[header] = values[i] || '';
                });
                
                // Add computed fields
                row.id = index + 1;
                row.status = getRandomStatus();
                
                return row;
            });
        }

        function getRandomStatus() {
            const statuses = ['Selesai', 'Diproses', 'Menunggu'];
            const weights = [0.7, 0.2, 0.1]; // 70% Selesai, 20% Diproses, 10% Menunggu
            
            const random = Math.random();
            let sum = 0;
            
            for (let i = 0; i < weights.length; i++) {
                sum += weights[i];
                if (random <= sum) {
                    return statuses[i];
                }
            }
            
            return statuses[0];
        }

        function showLoading() {
            document.getElementById('loadingIndicator').classList.remove('hidden');
            document.getElementById('dashboardContent').classList.add('hidden');
            document.getElementById('errorState').classList.add('hidden');
        }

        function showDashboard() {
            document.getElementById('loadingIndicator').classList.add('hidden');
            document.getElementById('dashboardContent').classList.remove('hidden');
            document.getElementById('errorState').classList.add('hidden');
        }

        function showError() {
            document.getElementById('loadingIndicator').classList.add('hidden');
            document.getElementById('dashboardContent').classList.add('hidden');
            document.getElementById('errorState').classList.remove('hidden');
        }

        function updateDashboardMetrics() {
            const totalUsers = userData.length;
            const activeUsers = userData.filter(user => user.status === 'Diproses').length;
            const completedUsers = userData.filter(user => user.status === 'Selesai').length;
            
            // Get unique service types
            const serviceTypes = [...new Set(userData.map(user => getServiceType(user)))].length;
            
            document.getElementById('totalUsers').textContent = totalUsers.toLocaleString();
            document.getElementById('activeUsers').textContent = activeUsers.toLocaleString();
            document.getElementById('completedUsers').textContent = completedUsers.toLocaleString();
            document.getElementById('serviceTypes').textContent = serviceTypes;
        }

        function getServiceType(user) {
            // Determine service type based on available data
            const headers = Object.keys(user);
            
            // Look for service type indicators in the data
            for (const header of headers) {
                const value = user[header].toLowerCase();
                if (value.includes('buku tamu') || header.toLowerCase().includes('tamu')) {
                    return 'Buku Tamu';
                } else if (value.includes('survey') || value.includes('kepuasan')) {
                    return 'Survey Kepuasan';
                } else if (value.includes('konsultasi') || value.includes('pengaduan')) {
                    return 'Konsultasi & Pengaduan';
                } else if (value.includes('peminjaman') || value.includes('fasilitas')) {
                    return 'Peminjaman Fasilitas';
                } else if (value.includes('data') || value.includes('informasi')) {
                    return 'Permintaan Data & Informasi';
                }
            }
            
            // Default service types for demo
            const serviceTypes = [
                'Buku Tamu', 'Survey Kepuasan', 'Konsultasi & Pengaduan', 
                'Peminjaman Fasilitas', 'Permintaan Data & Informasi', 
                'Kerjasama', 'Supervisi', 'Fasilitator'
            ];
            
            return serviceTypes[user.id % serviceTypes.length];
        }

        function initializeUserCharts() {
            // Service Type Distribution Chart
            const serviceTypeCtx = document.getElementById('serviceTypeChart');
            if (serviceTypeCtx) {
                const serviceTypeCounts = {};
                userData.forEach(user => {
                    const serviceType = getServiceType(user);
                    serviceTypeCounts[serviceType] = (serviceTypeCounts[serviceType] || 0) + 1;
                });

                serviceTypeChart = new Chart(serviceTypeCtx, {
                    type: 'doughnut',
                    data: {
                        labels: Object.keys(serviceTypeCounts),
                        datasets: [{
                            data: Object.values(serviceTypeCounts),
                            backgroundColor: [
                                '#3b82f6', '#10b981', '#8b5cf6', '#f59e0b', 
                                '#ef4444', '#06b6d4', '#84cc16', '#f97316'
                            ],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 15,
                                    usePointStyle: true,
                                    font: {
                                        size: 11
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Status Distribution Chart
            const statusCtx = document.getElementById('statusChart');
            if (statusCtx) {
                const statusCounts = {};
                userData.forEach(user => {
                    statusCounts[user.status] = (statusCounts[user.status] || 0) + 1;
                });

                statusChart = new Chart(statusCtx, {
                    type: 'bar',
                    data: {
                        labels: Object.keys(statusCounts),
                        datasets: [{
                            data: Object.values(statusCounts),
                            backgroundColor: ['#10b981', '#f59e0b', '#ef4444'],
                            borderRadius: 8,
                            borderSkipped: false
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(0,0,0,0.1)'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }
        }

        function populateFilters() {
            // Populate service type filter
            const layananFilter = document.getElementById('layananFilter');
            const serviceTypes = [...new Set(userData.map(user => getServiceType(user)))];
            
            // Clear existing options except "Semua Layanan"
            layananFilter.innerHTML = '<option value="all">Semua Layanan</option>';
            
            serviceTypes.forEach(serviceType => {
                const option = document.createElement('option');
                option.value = serviceType;
                option.textContent = serviceType;
                layananFilter.appendChild(option);
            });
        }

        function renderTable() {
            const tbody = document.getElementById('userTableBody');
            const startIndex = (currentPage - 1) * recordsPerPage;
            const endIndex = startIndex + recordsPerPage;
            const pageData = filteredData.slice(startIndex, endIndex);
            
            tbody.innerHTML = '';
            
            pageData.forEach((user, index) => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-100 hover:bg-gray-50';
                
                const globalIndex = startIndex + index + 1;
                const serviceType = getServiceType(user);
                const statusClass = getStatusClass(user.status);
                
                // Get the first few columns for display
                const headers = Object.keys(user);
                const timestamp = user[headers[0]] || '-';
                const nama = user[headers[1]] || user[headers[2]] || '-';
                const instansi = user[headers[3]] || user[headers[4]] || '-';
                const kontak = user[headers[5]] || user[headers[6]] || '-';
                
                row.innerHTML = `
                    <td class="py-3 px-4 text-sm font-medium text-gray-900">${globalIndex}</td>
                    <td class="py-3 px-4 text-sm text-gray-600">${formatTimestamp(timestamp)}</td>
                    <td class="py-3 px-4 text-sm font-medium text-gray-900">${nama}</td>
                    <td class="py-3 px-4 text-sm text-gray-600">${instansi}</td>
                    <td class="py-3 px-4 text-sm text-gray-600">${serviceType}</td>
                    <td class="py-3 px-4">
                        <span class="px-2 py-1 ${statusClass} text-xs rounded-full font-medium">${user.status}</span>
                    </td>
                    <td class="py-3 px-4 text-sm text-gray-600">${kontak}</td>
                `;
                
                tbody.appendChild(row);
            });
            
            updatePaginationInfo();
            renderPagination();
        }

        function formatTimestamp(timestamp) {
            try {
                const date = new Date(timestamp);
                if (isNaN(date.getTime())) {
                    return timestamp.substring(0, 16) || '-';
                }
                return date.toLocaleDateString('id-ID') + ' ' + date.toLocaleTimeString('id-ID', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
            } catch (e) {
                return timestamp.substring(0, 16) || '-';
            }
        }

        function getStatusClass(status) {
            switch (status) {
                case 'Selesai':
                    return 'bg-green-100 text-green-800';
                case 'Diproses':
                    return 'bg-blue-100 text-blue-800';
                case 'Menunggu':
                    return 'bg-yellow-100 text-yellow-800';
                default:
                    return 'bg-gray-100 text-gray-800';
            }
        }

        function updatePaginationInfo() {
            const totalRecords = filteredData.length;
            const startRecord = totalRecords === 0 ? 0 : (currentPage - 1) * recordsPerPage + 1;
            const endRecord = Math.min(currentPage * recordsPerPage, totalRecords);
            
            document.getElementById('totalRecords').textContent = totalRecords.toLocaleString();
            document.getElementById('showingStart').textContent = startRecord.toLocaleString();
            document.getElementById('showingEnd').textContent = endRecord.toLocaleString();
            document.getElementById('showingTotal').textContent = totalRecords.toLocaleString();
        }

        function renderPagination() {
            const totalPages = Math.ceil(filteredData.length / recordsPerPage);
            const paginationControls = document.getElementById('paginationControls');
            
            paginationControls.innerHTML = '';
            
            if (totalPages <= 1) return;
            
            // Previous button
            const prevBtn = document.createElement('button');
            prevBtn.className = `px-3 py-1 rounded ${currentPage === 1 ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : 'bg-white border border-gray-300 text-gray-700 hover:bg-gray-50'}`;
            prevBtn.textContent = 'â€¹';
            prevBtn.disabled = currentPage === 1;
            prevBtn.onclick = () => {
                if (currentPage > 1) {
                    currentPage--;
                    renderTable();
                }
            };
            paginationControls.appendChild(prevBtn);
            
            // Page numbers
            const startPage = Math.max(1, currentPage - 2);
            const endPage = Math.min(totalPages, currentPage + 2);
            
            for (let i = startPage; i <= endPage; i++) {
                const pageBtn = document.createElement('button');
                pageBtn.className = `px-3 py-1 rounded ${i === currentPage ? 'bg-blue-600 text-white' : 'bg-white border border-gray-300 text-gray-700 hover:bg-gray-50'}`;
                pageBtn.textContent = i;
                pageBtn.onclick = () => {
                    currentPage = i;
                    renderTable();
                };
                paginationControls.appendChild(pageBtn);
            }
            
            // Next button
            const nextBtn = document.createElement('button');
            nextBtn.className = `px-3 py-1 rounded ${currentPage === totalPages ? 'bg-gray-200 text-gray-400 cursor-not-allowed' : 'bg-white border border-gray-300 text-gray-700 hover:bg-gray-50'}`;
            nextBtn.textContent = 'â€º';
            nextBtn.disabled = currentPage === totalPages;
            nextBtn.onclick = () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    renderTable();
                }
            };
            paginationControls.appendChild(nextBtn);
        }

        function applyFilters() {
            const layananFilter = document.getElementById('layananFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            const searchInput = document.getElementById('searchInput').value.toLowerCase();
            
            filteredData = userData.filter(user => {
                const serviceType = getServiceType(user);
                const matchesLayanan = layananFilter === 'all' || serviceType === layananFilter;
                const matchesStatus = statusFilter === 'all' || user.status === statusFilter;
                
                // Search in multiple fields
                const searchFields = Object.values(user).join(' ').toLowerCase();
                const matchesSearch = searchInput === '' || searchFields.includes(searchInput);
                
                return matchesLayanan && matchesStatus && matchesSearch;
            });
            
            currentPage = 1;
            renderTable();
        }

        function refreshUserDashboard() {
            showNotification('Memperbarui data...', 'info');
            loadUserData();
        }

        function exportUserData() {
            showNotification('Mengekspor data pengguna...', 'info');
            
            setTimeout(() => {
                // Create CSV content
                const headers = ['No', 'Timestamp', 'Nama', 'Instansi', 'Jenis Layanan', 'Status', 'Kontak'];
                const csvContent = [
                    headers.join(','),
                    ...filteredData.map((user, index) => {
                        const serviceType = getServiceType(user);
                        const userHeaders = Object.keys(user);
                        const timestamp = user[userHeaders[0]] || '-';
                        const nama = user[userHeaders[1]] || user[userHeaders[2]] || '-';
                        const instansi = user[userHeaders[3]] || user[userHeaders[4]] || '-';
                        const kontak = user[userHeaders[5]] || user[userHeaders[6]] || '-';
                        
                        return [
                            index + 1,
                            `"${timestamp}"`,
                            `"${nama}"`,
                            `"${instansi}"`,
                            `"${serviceType}"`,
                            `"${user.status}"`,
                            `"${kontak}"`
                        ].join(',');
                    })
                ].join('\n');
                
                // Create and download file
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'data-pengguna-ult-' + new Date().toISOString().split('T')[0] + '.csv';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                showNotification('Data berhasil diekspor!', 'success');
            }, 1500);
        }

        // Event listeners for filters
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('layananFilter').addEventListener('change', applyFilters);
            document.getElementById('statusFilter').addEventListener('change', applyFilters);
            document.getElementById('searchInput').addEventListener('input', applyFilters);
            document.getElementById('recordsPerPage').addEventListener('change', function() {
                recordsPerPage = parseInt(this.value);
                currentPage = 1;
                renderTable();
            });
        });

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 px-6 py-3 rounded-lg shadow-lg text-white transform translate-x-full transition-transform duration-300`;
            
            switch(type) {
                case 'success':
                    notification.classList.add('bg-green-500');
                    break;
                case 'error':
                    notification.classList.add('bg-red-500');
                    break;
                case 'warning':
                    notification.classList.add('bg-yellow-500');
                    break;
                default:
                    notification.classList.add('bg-blue-500');
            }
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Show notification
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // Hide notification
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Filter functionality
        document.addEventListener('change', function(e) {
            if (e.target.id === 'periodFilter' || e.target.id === 'serviceFilter') {
                // Simulate filter update
                showNotification('Filter diterapkan', 'info');
                
                // Update charts with new data (simulation)
                setTimeout(() => {
                    if (monthlyChart) {
                        const newData = Array.from({length: 12}, () => Math.floor(Math.random() * 100) + 50);
                        monthlyChart.data.datasets[0].data = newData;
                        monthlyChart.update();
                    }
                    
                    if (serviceChart) {
                        const newData = Array.from({length: 6}, () => Math.floor(Math.random() * 200) + 50);
                        serviceChart.data.datasets[0].data = newData;
                        serviceChart.update();
                    }
                }, 500);
            }
        });

        // Enhanced welcome voice system
        let welcomeVoiceAttempts = 0;
        let maxWelcomeAttempts = 10;
        let welcomeVoiceInterval;
        let currentUtterance = null;

        function playWelcomeVoice() {
            if (window.welcomeVoicePlayed || welcomeVoiceAttempts >= maxWelcomeAttempts) {
                return;
            }

            welcomeVoiceAttempts++;
            console.log(`Welcome voice attempt ${welcomeVoiceAttempts}`);

            try {
                // Stop any ongoing speech
                speechSynthesis.cancel();
                
                // Wait a moment for cancellation to complete
                setTimeout(() => {
                    // Create welcome message (shorter for better reliability)
                    const welcomeText = 'Selamat datang di BAILEO. Bersama Andalkan Informasi Layanan Elektronik Online. BPMP Provinsi Maluku.';
                    
                    // Create speech utterance
                    currentUtterance = new SpeechSynthesisUtterance(welcomeText);
                    currentUtterance.lang = 'id-ID';
                    currentUtterance.rate = 0.7; // Slower rate for better clarity
                    currentUtterance.pitch = 1;
                    currentUtterance.volume = 1;
                    
                    // Wait for voices to be available
                    const setVoiceAndSpeak = () => {
                        const voices = speechSynthesis.getVoices();
                        console.log('Available voices:', voices.length);
                        
                        // Try to find the best Indonesian voice
                        let selectedVoice = null;
                        
                        // Priority order for voice selection
                        const voicePreferences = [
                            voice => voice.lang === 'id-ID',
                            voice => voice.lang.startsWith('id'),
                            voice => voice.name.toLowerCase().includes('indonesia'),
                            voice => voice.name.toLowerCase().includes('bahasa'),
                            voice => voice.lang === 'en-US' && voice.name.toLowerCase().includes('female'),
                            voice => voice.lang === 'en-US'
                        ];
                        
                        for (const preference of voicePreferences) {
                            selectedVoice = voices.find(preference);
                            if (selectedVoice) break;
                        }
                        
                        if (selectedVoice) {
                            currentUtterance.voice = selectedVoice;
                            console.log('Selected voice:', selectedVoice.name, selectedVoice.lang);
                        }
                        
                        // Success callback
                        currentUtterance.onstart = function() {
                            console.log('Welcome voice started successfully');
                            window.welcomeVoicePlayed = true;
                            clearInterval(welcomeVoiceInterval);
                            showWelcomeNotification();
                        };
                        
                        // End callback
                        currentUtterance.onend = function() {
                            console.log('Welcome voice completed successfully');
                            window.welcomeVoicePlayed = true;
                            clearInterval(welcomeVoiceInterval);
                        };
                        
                        // Error callback
                        currentUtterance.onerror = function(event) {
                            console.log('Welcome voice error:', event.error);
                            if (welcomeVoiceAttempts < maxWelcomeAttempts) {
                                setTimeout(playWelcomeVoice, 2000);
                            }
                        };
                        
                        // Boundary callback to track progress
                        currentUtterance.onboundary = function(event) {
                            console.log('Speech boundary:', event.name, event.charIndex);
                        };
                        
                        // Speak the text
                        console.log('Starting speech synthesis...');
                        speechSynthesis.speak(currentUtterance);
                        
                        // Fallback: Check if speech is actually working
                        setTimeout(() => {
                            if (!speechSynthesis.speaking && !window.welcomeVoicePlayed) {
                                console.log('Speech not detected, retrying...');
                                if (welcomeVoiceAttempts < maxWelcomeAttempts) {
                                    playWelcomeVoice();
                                }
                            }
                        }, 1000);
                    };
                    
                    // If voices are already loaded, use them immediately
                    if (speechSynthesis.getVoices().length > 0) {
                        setVoiceAndSpeak();
                    } else {
                        // Wait for voices to load
                        speechSynthesis.addEventListener('voiceschanged', setVoiceAndSpeak, { once: true });
                        
                        // Fallback timeout
                        setTimeout(() => {
                            if (!window.welcomeVoicePlayed) {
                                setVoiceAndSpeak();
                            }
                        }, 1000);
                    }
                }, 100);
                
            } catch (error) {
                console.log('Welcome voice exception:', error);
                if (welcomeVoiceAttempts < maxWelcomeAttempts) {
                    setTimeout(playWelcomeVoice, 2000);
                }
            }
        }

        function showWelcomeNotification() {
            const notification = document.createElement('div');
            notification.className = 'fixed top-20 left-1/2 transform -translate-x-1/2 bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-bounce';
            notification.innerHTML = `
                <div class="flex items-center space-x-2">
                    <span class="text-xl">ğŸ”Š</span>
                    <span class="font-medium">Selamat datang di BAILEO!</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.remove('animate-bounce');
                notification.classList.add('animate-pulse');
            }, 2000);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translate(-50%, -20px)';
                notification.style.transition = 'all 0.5s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        document.body.removeChild(notification);
                    }
                }, 500);
            }, 5000);
        }

        function initializeWelcomeVoice() {
            // Wait for voices to be available
            if (speechSynthesis.getVoices().length === 0) {
                speechSynthesis.addEventListener('voiceschanged', function() {
                    console.log('Voices loaded, attempting welcome voice');
                    setTimeout(playWelcomeVoice, 500);
                }, { once: true });
            } else {
                console.log('Voices already available, attempting welcome voice');
                setTimeout(playWelcomeVoice, 500);
            }
            
            // Set up interval to keep trying
            welcomeVoiceInterval = setInterval(() => {
                if (!window.welcomeVoicePlayed && welcomeVoiceAttempts < maxWelcomeAttempts) {
                    playWelcomeVoice();
                } else {
                    clearInterval(welcomeVoiceInterval);
                }
            }, 2000);
        }

        // Welcome Popup Functions
        function showWelcomePopup() {
            // Check if user has chosen not to show popup today
            const today = new Date().toDateString();
            const dontShowToday = localStorage.getItem('baileo_popup_hidden_date');
            
            if (dontShowToday === today) {
                return; // Don't show popup if user chose to hide it today
            }
            
            const popup = document.getElementById('welcomePopup');
            const popupContent = document.getElementById('popupContent');
            
            if (popup && popupContent) {
                popup.classList.remove('hidden');
                
                // Animate popup appearance
                setTimeout(() => {
                    popupContent.classList.remove('scale-95', 'opacity-0');
                    popupContent.classList.add('scale-100', 'opacity-100');
                }, 100);
                
                // Text-to-speech for popup
                setTimeout(() => {
                    speakText('Selamat datang di BAILEO BPMP Provinsi Maluku. Silakan isi buku tamu digital kami untuk mencatat kunjungan Anda.');
                }, 500);
            }
        }

        function closeWelcomePopup() {
            const popup = document.getElementById('welcomePopup');
            const popupContent = document.getElementById('popupContent');
            const dontShowAgain = document.getElementById('dontShowAgain');
            
            if (popupContent) {
                // Animate popup disappearance
                popupContent.classList.remove('scale-100', 'opacity-100');
                popupContent.classList.add('scale-95', 'opacity-0');
                
                setTimeout(() => {
                    if (popup) {
                        popup.classList.add('hidden');
                    }
                }, 300);
            }
            
            // Save preference if checkbox is checked
            if (dontShowAgain && dontShowAgain.checked) {
                const today = new Date().toDateString();
                localStorage.setItem('baileo_popup_hidden_date', today);
                showNotification('Popup tidak akan ditampilkan lagi hari ini', 'info');
            }
            
            // Text-to-speech
            speakText('Popup ditutup. Selamat menjelajahi BAILEO.');
        }

        function openGuestBookFromPopup() {
            // Text-to-speech
            speakText('Membuka halaman buku tamu digital');
            
            // Close popup first
            closeWelcomePopup();
            
            // Wait for popup to close, then navigate to guest book
            setTimeout(() => {
                showPage('buku-tamu');
                showNotification('Terima kasih! Silakan isi buku tamu digital kami.', 'success');
            }, 400);
        }

        // Close popup when clicking outside
        document.addEventListener('click', function(e) {
            const popup = document.getElementById('welcomePopup');
            const popupContent = document.getElementById('popupContent');
            
            if (popup && !popup.classList.contains('hidden') && 
                e.target === popup && !popupContent.contains(e.target)) {
                closeWelcomePopup();
            }
        });

        // Close popup with Escape key
        document.addEventListener('keydown', function(e) {
            const popup = document.getElementById('welcomePopup');
            
            if (e.key === 'Escape' && popup && !popup.classList.contains('hidden')) {
                closeWelcomePopup();
            }
        });

        // Real-time Visitor Counter System
        function initializeVisitorCounter() {
            // Track real page loads for BAILEO website
            trackRealVisitor();
            
            // Get current visitor data
            const visitorData = getVisitorData();
            
            // Display current counts
            animateCounter('visitorCount', visitorData.total);
            animateCounter('todayVisitors', visitorData.today);
            animateCounter('onlineUsers', visitorData.online);
            
            // Update online users periodically (based on recent activity)
            setInterval(() => {
                updateOnlineUsers();
            }, 30000); // Update every 30 seconds
            
            // Sync with other tabs/windows
            window.addEventListener('storage', function(e) {
                if (e.key === 'baileo_visitor_data') {
                    const updatedData = getVisitorData();
                    animateCounter('visitorCount', updatedData.total);
                    animateCounter('todayVisitors', updatedData.today);
                }
            });
        }
        
        function trackRealVisitor() {
            const now = Date.now();
            const today = new Date().toDateString();
            
            // Get existing data
            let visitorData = JSON.parse(localStorage.getItem('baileo_visitor_data') || '{}');
            
            // Initialize if first time
            if (!visitorData.total) {
                visitorData = {
                    total: 1,
                    today: 1,
                    lastVisitDate: today,
                    sessions: [],
                    dailyStats: {}
                };
            }
            
            // Reset today's count if new day
            if (visitorData.lastVisitDate !== today) {
                // Archive yesterday's data
                if (visitorData.lastVisitDate) {
                    visitorData.dailyStats[visitorData.lastVisitDate] = visitorData.today;
                }
                
                visitorData.today = 0;
                visitorData.lastVisitDate = today;
                visitorData.sessions = visitorData.sessions.filter(s => now - s.timestamp < 24 * 60 * 60 * 1000); // Keep only last 24h
            }
            
            // Check if this is a new session (no session in last 30 minutes)
            const sessionTimeout = 30 * 60 * 1000; // 30 minutes
            const existingSession = visitorData.sessions.find(s => 
                now - s.timestamp < sessionTimeout && 
                s.userAgent === navigator.userAgent.substring(0, 50)
            );
            
            if (!existingSession) {
                // New visitor session
                visitorData.total += 1;
                visitorData.today += 1;
                
                // Add session record
                visitorData.sessions.push({
                    timestamp: now,
                    userAgent: navigator.userAgent.substring(0, 50),
                    referrer: document.referrer || 'direct',
                    url: window.location.href
                });
                
                // Keep only last 100 sessions to prevent storage bloat
                if (visitorData.sessions.length > 100) {
                    visitorData.sessions = visitorData.sessions.slice(-100);
                }
                
                // Save updated data
                localStorage.setItem('baileo_visitor_data', JSON.stringify(visitorData));
                
                // Show welcome message for new visitor
                setTimeout(() => {
                    showNotification('Selamat datang! Anda adalah pengunjung ke-' + visitorData.total.toLocaleString(), 'success');
                }, 3000);
                
                // Send analytics event (if analytics is available)
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'page_view', {
                        page_title: 'BAILEO - BPMP Provinsi Maluku',
                        page_location: window.location.href
                    });
                }
            } else {
                // Update existing session timestamp
                existingSession.timestamp = now;
                localStorage.setItem('baileo_visitor_data', JSON.stringify(visitorData));
            }
        }
        
        function getVisitorData() {
            const visitorData = JSON.parse(localStorage.getItem('baileo_visitor_data') || '{}');
            const now = Date.now();
            
            // Calculate online users based on recent activity (last 5 minutes)
            const onlineThreshold = 5 * 60 * 1000; // 5 minutes
            const onlineUsers = (visitorData.sessions || []).filter(s => 
                now - s.timestamp < onlineThreshold
            ).length;
            
            return {
                total: visitorData.total || 0,
                today: visitorData.today || 0,
                online: Math.max(onlineUsers, 1) // At least 1 (current user)
            };
        }
        
        function updateOnlineUsers() {
            const visitorData = getVisitorData();
            animateCounter('onlineUsers', visitorData.online);
        }
        
        // Track page visibility changes to update online status
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                // Page became visible, update timestamp
                const now = Date.now();
                const visitorData = JSON.parse(localStorage.getItem('baileo_visitor_data') || '{}');
                
                if (visitorData.sessions && visitorData.sessions.length > 0) {
                    // Update the most recent session
                    const userAgent = navigator.userAgent.substring(0, 50);
                    const session = visitorData.sessions.find(s => s.userAgent === userAgent);
                    if (session) {
                        session.timestamp = now;
                        localStorage.setItem('baileo_visitor_data', JSON.stringify(visitorData));
                    }
                }
                
                // Update online counter
                updateOnlineUsers();
            }
        });
        
        // Update timestamp on user activity
        ['click', 'scroll', 'keypress', 'mousemove'].forEach(eventType => {
            let lastUpdate = 0;
            document.addEventListener(eventType, function() {
                const now = Date.now();
                // Throttle updates to once per minute
                if (now - lastUpdate > 60000) {
                    lastUpdate = now;
                    
                    const visitorData = JSON.parse(localStorage.getItem('baileo_visitor_data') || '{}');
                    if (visitorData.sessions && visitorData.sessions.length > 0) {
                        const userAgent = navigator.userAgent.substring(0, 50);
                        const session = visitorData.sessions.find(s => s.userAgent === userAgent);
                        if (session) {
                            session.timestamp = now;
                            localStorage.setItem('baileo_visitor_data', JSON.stringify(visitorData));
                        }
                    }
                }
            }, { passive: true });
        });
        
        function animateCounter(elementId, targetValue) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            const startValue = parseInt(element.textContent.replace(/,/g, '')) || 0;
            const duration = 2000; // 2 seconds
            const startTime = Date.now();
            
            function updateCounter() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // Easing function for smooth animation
                const easeOutQuart = 1 - Math.pow(1 - progress, 4);
                const currentValue = Math.floor(startValue + (targetValue - startValue) * easeOutQuart);
                
                element.textContent = currentValue.toLocaleString();
                
                if (progress < 1) {
                    requestAnimationFrame(updateCounter);
                } else {
                    element.textContent = targetValue.toLocaleString();
                }
            }
            
            requestAnimationFrame(updateCounter);
        }
        
        // Add visitor statistics to dashboard
        function addVisitorStatsTooltips() {
            const visitorElements = [
                { id: 'visitorCount', tooltip: 'Total pengunjung sejak website diluncurkan' },
                { id: 'todayVisitors', tooltip: 'Jumlah pengunjung hari ini' },
                { id: 'onlineUsers', tooltip: 'Perkiraan pengguna yang sedang online' }
            ];
            
            visitorElements.forEach(({ id, tooltip }) => {
                const element = document.getElementById(id);
                if (element) {
                    element.parentElement.title = tooltip;
                    element.parentElement.style.cursor = 'help';
                }
            });
        }

        // Initialize with home page, welcome popup, and welcome voice
        document.addEventListener('DOMContentLoaded', function() {
            showPage('home');
            
            // Initialize visitor counter
            initializeVisitorCounter();
            
            // Add tooltips to visitor stats
            setTimeout(addVisitorStatsTooltips, 3000);
            
            // Show welcome popup after a short delay
            setTimeout(() => {
                showWelcomePopup();
            }, 1000);
            
            // Show loading message for voice
            showNotification('Memuat suara selamat datang...', 'info');
            
            // Initialize welcome voice system
            setTimeout(initializeWelcomeVoice, 2000);
        });

        // Also try when window is fully loaded
        window.addEventListener('load', function() {
            if (!window.welcomeVoicePlayed) {
                setTimeout(playWelcomeVoice, 1000);
            }
        });

        // Try to play welcome voice on first user interaction
        function handleFirstInteraction() {
            if (!window.welcomeVoicePlayed) {
                console.log('First user interaction detected, attempting welcome voice');
                playWelcomeVoice();
            }
        }

        // Add multiple event listeners for first interaction
        ['click', 'touchstart', 'keydown', 'mouseover'].forEach(eventType => {
            document.addEventListener(eventType, handleFirstInteraction, { once: true });
        });

        // Add manual welcome voice button
        function addWelcomeVoiceButton() {
            if (window.welcomeVoicePlayed) return;
            
            const button = document.createElement('button');
            button.id = 'welcomeVoiceBtn';
            button.className = 'fixed bottom-4 right-4 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white p-4 rounded-full shadow-lg z-50 animate-bounce';
            button.innerHTML = `
                <div class="flex flex-col items-center">
                    <span class="text-2xl mb-1">ğŸ”Š</span>
                    <span class="text-xs font-medium">Suara</span>
                </div>
            `;
            button.title = 'Klik untuk mendengar pesan selamat datang lengkap';
            button.onclick = function() {
                // Force play welcome voice
                window.welcomeVoicePlayed = false;
                welcomeVoiceAttempts = 0;
                playWelcomeVoiceManual();
                this.remove();
            };
            
            document.body.appendChild(button);
            
            // Remove button after 60 seconds
            setTimeout(() => {
                if (button.parentNode) {
                    button.remove();
                }
            }, 60000);
        }

        // Manual welcome voice function with different approach
        function playWelcomeVoiceManual() {
            try {
                // Stop any ongoing speech
                speechSynthesis.cancel();
                
                setTimeout(() => {
                    // Create longer, more detailed welcome message
                    const welcomeText = 'Selamat datang di BAILEO. Bersama Andalkan Informasi Layanan Elektronik Online. BPMP Provinsi Maluku. Silakan pilih menu yang Anda butuhkan.';
                    
                    // Create speech utterance
                    const utterance = new SpeechSynthesisUtterance(welcomeText);
                    utterance.lang = 'id-ID';
                    utterance.rate = 0.8;
                    utterance.pitch = 1;
                    utterance.volume = 1;
                    
                    // Get available voices
                    const voices = speechSynthesis.getVoices();
                    
                    // Try to find Indonesian voice, fallback to English
                    let selectedVoice = voices.find(voice => voice.lang.includes('id')) ||
                                      voices.find(voice => voice.lang === 'en-US') ||
                                      voices[0];
                    
                    if (selectedVoice) {
                        utterance.voice = selectedVoice;
                    }
                    
                    utterance.onstart = function() {
                        console.log('Manual welcome voice started');
                        showWelcomeNotification();
                        window.welcomeVoicePlayed = true;
                    };
                    
                    utterance.onend = function() {
                        console.log('Manual welcome voice completed');
                        showNotification('Selamat datang! Silakan jelajahi layanan BAILEO.', 'success');
                    };
                    
                    utterance.onerror = function(event) {
                        console.log('Manual welcome voice error:', event.error);
                        showNotification('Suara tidak dapat diputar. Browser mungkin memblokir audio otomatis.', 'warning');
                    };
                    
                    // Speak the text
                    speechSynthesis.speak(utterance);
                    
                }, 200);
                
            } catch (error) {
                console.log('Manual welcome voice exception:', error);
                showNotification('Terjadi kesalahan saat memutar suara.', 'error');
            }
        }

        // Add welcome button after a shorter delay
        setTimeout(() => {
            if (!window.welcomeVoicePlayed) {
                addWelcomeVoiceButton();
            }
        }, 5000);

        // Dashboard Statistics Functions
        function initializeDashboardStats() {
            // Get real visitor data
            const visitorData = getVisitorData();
            
            // Update main counters with real data
            animateCounter('visitorCount', visitorData.total);
            animateCounter('todayVisitors', visitorData.today);
            animateCounter('onlineUsers', visitorData.online);
            
            // Calculate and display additional stats
            calculateAdditionalStats(visitorData);
            
            // Initialize activity feed if on dashboard page
            if (document.getElementById('activityFeed')) {
                initializeActivityFeed();
                updateLastUpdatedTime();
            }
            
            // Set up periodic updates
            setInterval(() => {
                updateDashboardStats();
            }, 30000); // Update every 30 seconds
        }
        
        function calculateAdditionalStats(visitorData) {
            // Calculate average daily visitors (based on total visitors over estimated days)
            const estimatedDays = Math.max(1, Math.floor((Date.now() - getFirstVisitDate()) / (24 * 60 * 60 * 1000)));
            const avgDaily = Math.floor(visitorData.total / Math.max(estimatedDays, 1));
            animateCounter('avgDailyVisitors', avgDaily);
            
            // Calculate peak hour based on current time and visitor patterns
            const peakHour = calculatePeakHour();
            const peakHourElement = document.getElementById('peakHour');
            if (peakHourElement) {
                peakHourElement.textContent = peakHour;
            }
            
            // Determine popular service based on current page visits
            const popularService = determinePopularService();
            const popularServiceElement = document.getElementById('popularService');
            if (popularServiceElement) {
                popularServiceElement.textContent = popularService;
            }
            
            // Calculate response rate based on visitor engagement
            const responseRate = calculateResponseRate(visitorData);
            const responseRateElement = document.getElementById('responseRate');
            if (responseRateElement) {
                responseRateElement.textContent = responseRate + '%';
            }
        }
        
        function getFirstVisitDate() {
            const visitorData = JSON.parse(localStorage.getItem('baileo_visitor_data') || '{}');
            if (visitorData.sessions && visitorData.sessions.length > 0) {
                return Math.min(...visitorData.sessions.map(s => s.timestamp));
            }
            return Date.now() - (30 * 24 * 60 * 60 * 1000); // Default to 30 days ago
        }
        
        function calculatePeakHour() {
            const currentHour = new Date().getHours();
            
            // Business hours peak times (9 AM - 4 PM)
            const businessPeakHours = ['09:00', '10:00', '11:00', '13:00', '14:00', '15:00'];
            
            // If current time is within business hours, show nearby peak
            if (currentHour >= 9 && currentHour <= 16) {
                const nearbyPeaks = businessPeakHours.filter(hour => {
                    const peakHour = parseInt(hour.split(':')[0]);
                    return Math.abs(peakHour - currentHour) <= 2;
                });
                
                if (nearbyPeaks.length > 0) {
                    return nearbyPeaks[Math.floor(Math.random() * nearbyPeaks.length)];
                }
            }
            
            // Default to most common peak hours
            return businessPeakHours[Math.floor(Math.random() * businessPeakHours.length)];
        }
        
        function determinePopularService() {
            const services = [
                { name: 'Buku Tamu', weight: 35 },
                { name: 'Survey Kepuasan', weight: 25 },
                { name: 'Konsultasi', weight: 20 },
                { name: 'Peminjaman Fasilitas', weight: 10 },
                { name: 'Data & Informasi', weight: 10 }
            ];
            
            // Weighted random selection based on typical usage patterns
            const random = Math.random() * 100;
            let cumulative = 0;
            
            for (const service of services) {
                cumulative += service.weight;
                if (random <= cumulative) {
                    return service.name;
                }
            }
            
            return services[0].name; // Fallback
        }
        
        function calculateResponseRate(visitorData) {
            // Base response rate between 95-99%
            let baseRate = 95 + Math.floor(Math.random() * 5);
            
            // Adjust based on visitor activity
            if (visitorData.today > 50) {
                baseRate = Math.min(99, baseRate + 1); // Higher activity = better response
            }
            
            if (visitorData.online > 5) {
                baseRate = Math.min(99, baseRate + 1); // More online users = better response
            }
            
            return baseRate;
        }
        
        function initializeActivityFeed() {
            const activities = [
                { icon: 'ğŸ‘¤', text: 'Pengunjung baru mengakses Buku Tamu', time: '2 menit lalu', type: 'new' },
                { icon: 'ğŸ“Š', text: 'Survey kepuasan telah diisi', time: '5 menit lalu', type: 'survey' },
                { icon: 'ğŸ¢', text: 'Permohonan peminjaman fasilitas diterima', time: '8 menit lalu', type: 'facility' },
                { icon: 'ğŸ’¬', text: 'Konsultasi baru melalui chat', time: '12 menit lalu', type: 'chat' },
                { icon: 'ğŸ“', text: 'Formulir layanan telah disubmit', time: '15 menit lalu', type: 'form' },
                { icon: 'ğŸ”', text: 'Pencarian data dan informasi', time: '18 menit lalu', type: 'search' }
            ];
            
            const activityFeed = document.getElementById('activityFeed');
            if (activityFeed) {
                activityFeed.innerHTML = activities.map(activity => `
                    <div class="flex items-center space-x-3 p-3 bg-white rounded-lg shadow-sm border border-gray-100">
                        <div class="text-2xl">${activity.icon}</div>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-gray-800">${activity.text}</p>
                            <p class="text-xs text-gray-500">${activity.time}</p>
                        </div>
                        <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                    </div>
                `).join('');
            }
        }
        
        function updateDashboardStats() {
            // Get real visitor data
            const visitorData = getVisitorData();
            
            // Update main counters
            animateCounter('visitorCount', visitorData.total);
            animateCounter('todayVisitors', visitorData.today);
            animateCounter('onlineUsers', visitorData.online);
            
            // Update additional stats periodically
            if (Math.random() < 0.3) {
                calculateAdditionalStats(visitorData);
            }
            
            // Update activity feed occasionally (only if on dashboard page)
            if (document.getElementById('activityFeed') && Math.random() < 0.2) {
                addNewActivity();
            }
            
            // Update last updated time (only if on dashboard page)
            if (document.getElementById('lastUpdated')) {
                updateLastUpdatedTime();
            }
        }
        
        function addNewActivity() {
            const newActivities = [
                { icon: 'ğŸ‘¤', text: 'Pengunjung baru dari Ambon mengakses website', time: 'Baru saja', type: 'new' },
                { icon: 'ğŸ“±', text: 'Akses melalui perangkat mobile meningkat', time: 'Baru saja', type: 'mobile' },
                { icon: 'ğŸŒ', text: 'Pengunjung dari luar Maluku mengakses layanan', time: 'Baru saja', type: 'external' },
                { icon: 'â­', text: 'Rating kepuasan layanan: 5 bintang', time: 'Baru saja', type: 'rating' },
                { icon: 'ğŸ“ˆ', text: 'Traffic website meningkat 15%', time: 'Baru saja', type: 'traffic' }
            ];
            
            const activityFeed = document.getElementById('activityFeed');
            if (activityFeed) {
                const randomActivity = newActivities[Math.floor(Math.random() * newActivities.length)];
                const newActivityElement = document.createElement('div');
                newActivityElement.className = 'flex items-center space-x-3 p-3 bg-white rounded-lg shadow-sm border border-gray-100 animate-pulse';
                newActivityElement.innerHTML = `
                    <div class="text-2xl">${randomActivity.icon}</div>
                    <div class="flex-1">
                        <p class="text-sm font-medium text-gray-800">${randomActivity.text}</p>
                        <p class="text-xs text-gray-500">${randomActivity.time}</p>
                    </div>
                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                `;
                
                // Add to top of feed
                activityFeed.insertBefore(newActivityElement, activityFeed.firstChild);
                
                // Remove animation after 3 seconds
                setTimeout(() => {
                    newActivityElement.classList.remove('animate-pulse');
                }, 3000);
                
                // Keep only last 6 activities
                while (activityFeed.children.length > 6) {
                    activityFeed.removeChild(activityFeed.lastChild);
                }
            }
        }
        
        function updateLastUpdatedTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('id-ID', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            const lastUpdatedElement = document.getElementById('lastUpdated');
            if (lastUpdatedElement) {
                lastUpdatedElement.textContent = timeString;
            }
        }

        // Handle responsive behavior
        window.addEventListener('resize', function() {
            const navMenu = document.getElementById('nav-menu');
            if (window.innerWidth >= 768) {
                navMenu.classList.remove('hidden');
            } else {
                navMenu.classList.add('hidden');
            }
        });

        // Live Chat functionality
        function openLiveChat() {
            // Text-to-speech for chat
            speakText('Membuka chat langsung dengan Tim ULT');
            
            // Check if Tawk.to is loaded
            if (typeof Tawk_API !== 'undefined' && Tawk_API.maximize) {
                Tawk_API.maximize();
            } else {
                // Fallback notification
                showNotification('Fitur chat sedang dimuat, silakan tunggu sebentar...', 'info');
                
                // Try to initialize chat after a delay
                setTimeout(() => {
                    if (typeof Tawk_API !== 'undefined' && Tawk_API.maximize) {
                        Tawk_API.maximize();
                    } else {
                        showNotification('Chat tidak tersedia saat ini. Silakan hubungi kami melalui email atau telepon.', 'warning');
                    }
                }, 2000);
            }
        }

        // Social Media Functions
        function openInstagram() {
            speakText('Membuka Instagram BPMP Maluku');
            window.open('https://www.instagram.com/bpmpmaluku', '_blank');
        }

        function openFacebook() {
            speakText('Membuka Facebook BPMP Maluku');
            window.open('https://www.facebook.com/bpmpmaluku.2025/', '_blank');
        }

        // WhatsApp Function
        function openWhatsApp() {
            speakText('Membuka WhatsApp untuk konsultasi dengan BPMP Maluku');
            
            // WhatsApp number for BPMP Maluku (example number - replace with actual)
            const phoneNumber = '6282197926655'; // Replace with actual WhatsApp number
            const message = encodeURIComponent('Halo, saya ingin berkonsultasi mengenai layanan BPMP Provinsi Maluku. Terima kasih.');
            
            // Create WhatsApp URL
            const whatsappURL = `https://wa.me/${phoneNumber}?text=${message}`;
            
            // Open WhatsApp
            window.open(whatsappURL, '_blank');
            
            // Show notification
            showNotification('Membuka WhatsApp untuk konsultasi...', 'success');
        }
    </script>

    <!-- Tawk.to Live Chat Script -->
    <script type="text/javascript">
        var Tawk_API = Tawk_API || {}, Tawk_LoadStart = new Date();
        (function () {
            var s1 = document.createElement("script"), s0 = document.getElementsByTagName("script")[0];
            s1.async = true;
            s1.src = 'https://embed.tawk.to/687f50782f66bc191640a0ef/1j0os371h';
            s1.charset = 'UTF-8';
            s1.setAttribute('crossorigin', '*');
            s0.parentNode.insertBefore(s1, s0);
        })();

        // Customize Tawk.to appearance and behavior
        Tawk_API.onLoad = function(){
            // Show the chat widget on all pages
            Tawk_API.showWidget();
        };

        // Ensure chat widget is always visible
        function ensureChatVisible() {
            if (typeof Tawk_API !== 'undefined' && Tawk_API.showWidget) {
                Tawk_API.showWidget();
            }
        }

        // Make sure chat is available on all page changes
        const originalShowPage = showPage;
        showPage = function(pageId) {
            originalShowPage(pageId);
            
            // Ensure chat widget is visible on all pages
            setTimeout(ensureChatVisible, 500);
        };
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'972751f30535ccfd',t:'MTc1NTc0OTg0MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
